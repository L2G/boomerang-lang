module Uniprot = 

(**** deleting space lenses *****)

(* del spaces. Default = "" *)
let del_spaces = del " "*

(* del spaces. Default = " " Better name to be found !*)
let del_spaces_bis = del " "+ | ""

(* delete the begining of lines. ("DE   ") *)
let del_beg_line (tag:string) = 
  del tag . del "   "



(***** XML escaping *****)
(* escaping of special XML char*)
let xml_esc (chars:regexp)= 
    ([^&<>\n] - chars)
  | ">" <-> "&gt;"
  | "<" <-> "&lt;"
  | "&" <-> "&amp;"

(* escaping of a "name", that does not contain any of the chars in
 * "char" and neither starts or finishes with spaces *)

let escape_name (chars:regexp) = 
  let esc = xml_esc chars in
  let esc_nospace = xml_esc (chars | " ") in
    (esc_nospace . esc* . esc_nospace) (* a long string wich begin and end with a non space char *)
  | esc_nospace (* or an (improbable) single char string *)


(* escaping of a "name", that does not contain any of the chars in
 * "char" and neither starts or finishes with spaces of is the single
 * char contained in [diff] (must be a single char !)*)
let escape_name_diff (chars:regexp) (diff:string) = 
  let esc = xml_esc chars in
  let esc_nospace = xml_esc (chars | " ") in
  let esc_nospace_unique = xml_esc (chars | " " | diff) in
    (esc_nospace . esc* . esc_nospace) (* a long string wich begin and end with a non space char *)
  | esc_nospace_unique (* or an (improbable) single char string *)


(* [xml_space space] is a q-lense that prints [space], but accepte in
 * the putback any number of paces. Usefull for the identation.*)
let xml_spaces (space:string) = qconst "" " "* space ""
let xml_space = xml_spaces " "
let xml_fs = qconst "" (" " . " "*) " " "" (* force space *)
let xml_os = xml_spaces "" (* stands for optional space *)

(* [xml_nl] is a q-lense that prints one new line character '\n' but
   accepte any sequence of newline and/or spaces in the put
   direction. This sequence necesseraly end by a '\n' to permit the
   next lens to begin with a [xml_space] *)
let xml_nl = qconst "" ((("\n" | " ")*."\n")?) "\n" ""

let xml_lt = ins "<" . xml_os
let xml_lts = ins "</" . xml_os
let xml_gt = ins ">"
let xml_sgt = ins "/>"

(* "  <name" *)
let xml_begin_open_tag (spaces:string) (name:string) = 
  xml_spaces spaces . 
  xml_lt . ins name . xml_fs

(* [xml_attribute name content space] deal with data that become
 * attributes in the XML file.  
 *
 * [name] is the name of the attribute
 * [content] is the lens dealing with the content
 * [space] is a string of spaces to be insert after the
 * attribute. Usualy "" or " " (if the attribute is or not the last
 * one) *)

(* name="content" *)

let xml_attribute_no_space (name:string) (content:lens) = 
  ins name . 
  xml_os . ins "=" .xml_os .ins "\"" .  (* "=\"" *)
  content . ins "\""

let xml_attribute (name:string) (content:lens) (space:string) = 
  xml_attribute_no_space name content . xml_spaces space

let xml_simple_attribute (name:string) (content:string) = 
  ins name . 
  xml_os . ins "=" .xml_os .ins "\"" .  (* "=\"" *)
  ins content . ins "\""

let xml_concat_attributes (att1:lens) (att2:lens) = 
  att1 . xml_space . att2

(* <name>content</name> \n *)

let xml_tag (spaces:string) (name:string) (content:lens) = 
  xml_spaces spaces . 
  xml_lt . ins name . xml_os . xml_gt . (* <name> *)
    content . 
  xml_lts . ins name . xml_os . xml_gt . xml_nl (* </name> *)

(* <name attribute>content</name> \n *)
(* !!! attribute is a lens that insert the attribute. It's to deal
   with spaces !!!*)

let xml_tag_with_att (spaces:string) (name:string) (attribute:lens) (content:lens) = 
  xml_spaces spaces . 
    xml_lt . ins name . xml_fs . attribute . xml_os . xml_gt . (* <name attribute> *)
    content . 
  xml_lts. ins name. xml_os . xml_gt . xml_nl (* </name>\n *)

(* <name name_att="content_att"/>\n *)

let xml_tag_with_single_att (spaces:string) (name:string) (name_att:string) (content_att:lens) = 
  xml_spaces spaces . 
  xml_lt . ins name . xml_fs . 
  ins name_att . xml_os . ins "=" . xml_os . ins "\"" . 
    content_att . 
  ins "\"" . xml_os . xml_sgt . xml_nl

(* <name>(\n)?*)

let xml_opening_tag_no_nl (spaces:string) (name:string) = 
  xml_spaces spaces . xml_lt . ins name . xml_os . xml_gt

let xml_opening_tag (spaces:string) (name:string) = 
  xml_opening_tag_no_nl spaces name . xml_nl 


(* <name attribute>(\n)? *)
let xml_opening_tag_with_att_no_nl (spaces:string) (name:string) (attribute:lens)  = 
  xml_spaces spaces . xml_lt . ins name . xml_fs . attribute . xml_gt
let xml_opening_tag_with_att (spaces:string) (name:string) (attribute:lens)  = 
  xml_opening_tag_with_att_no_nl spaces name attribute . xml_nl

(* </name>(\n)? *)
let xml_closing_tag_no_nl (spaces:string) (name:string) = 
  xml_spaces spaces . xml_lts . ins name. xml_os . xml_gt

let xml_closing_tag (spaces:string) (name:string) = 
  xml_closing_tag_no_nl spaces name . xml_nl 


(* several "date" lenses *)
let month = 
  ( "JAN" <-> "01"
  | "FEB" <-> "02"
  | "MAR" <-> "03"
  | "APR" <-> "04"
  | "MAY" <-> "05"
  | "JUN" <-> "06"
  | "JUL" <-> "07"
  | "AUG" <-> "08"
  | "SEP" <-> "09"
  | "OCT" <-> "10"
  | "NOV" <-> "11"
  | "DEC" <-> "12" )

(* full date *)
let date = 
  default
    ((([0-9]{2}) ~ ("-" . month . ins "-")) ~ (del "-" . [0-9]{4}))
    "01-JAN-1000"

(* partial date (month and year) *)
let partial_date = 
  default
    (del "(" . ((month . del "-") ~ ([0-9]{4} . ins "-")) . del ")")
    "(JAN-1000)"

test date get "20-FEB-2007" = "2007-02-20"


(* produce a "1" but accept any-number in the putback or create
   direction*)
let qone = qconst "" ([0-9]* ) "1" "" 






(*** definitions of lenses for each type of line ****)

(*** ID line ***)

let ID = 
  let content = key ([^ \n]+) . ( del "\n" | del (" ".[^\n]* . "\n")) in
    del_beg_line "ID" . xml_tag "  " "name" content 

test ID get 
<<<
ID   104K_THEAN              Reviewed;         893 AA.

>>> 
=
<<<  <name>104K_THEAN</name>
>>>


(**** AC line ****)


let accession = xml_tag "  " "accession" ([A-Z0-9]{6}) . del ";" 


let AC = del_beg_line "AC" . (accession . del_spaces_bis)*.accession .del "\n" 


test AC get
<<<
AC   Q92892; Q92893; Q92894; Q92895; Q93053; Q96KU9; Q96KV0; Q96KV1;

>>> = 
<<<  <accession>Q92892</accession>
  <accession>Q92893</accession>
  <accession>Q92894</accession>
  <accession>Q92895</accession>
  <accession>Q93053</accession>
  <accession>Q96KU9</accession>
  <accession>Q96KV0</accession>
  <accession>Q96KV1</accession>
>>>

test AC put
<<<<accession>Q92892</accession>
<accession>Q92893</accession>
 <accession>Q92894</accession>
  <accession>Q92895</accession>
  <accession>Q93053</accession>
 <accession>Q96KU9</accession>
  <accession>Q96KV0</accession>
  <accession>Q96KV1</accession>
  <accession>Q99605</accession>
>>>
into 
<<<
AC   Q99605;

>>>
=
"AC   Q92892; Q92893; Q92894; Q92895; Q93053; Q96KU9; Q96KV0; Q96KV1; Q99605;
"



(**** DT line ****)

let fst_DT = 
  del_beg_line "DT" .
  xml_begin_open_tag "" "entry" . 
  xml_attribute "created" date " ".
  del ", integrated into UniProtKB/" . 
  xml_attribute "dataset" (escape_name ["".]) " " . del ".\n" 

let snd_DT = 
  (* this second line is reflected at the end, in the <sequence> tag *)
  del_beg_line "DT" . 
  xml_attribute "modified" date " " ~ 
  (del ", sequence version " . xml_attribute "version" [0-9]* " ") . del ".\n"

let thd_DT = 
  del_beg_line "DT" . 
  xml_attribute "modified" date " " .
  del ", entry version " . xml_attribute "version" ([0-9]* ) "" . 
  xml_gt. xml_nl . del ".\n"
  

(*
test DT get 
<<<
DT   18-APR-2006, integrated into UniProtKB/Swiss-Prot.
DT   05-JUL-2005, sequence version 1.
DT   20-FEB-2007, entry version 10.

>>>=

<<<
<entry created="2006-04-18" dataset="Swiss-Prot" modified="2007-02-20" version="10">

>>>
*)


(******* DE line ********)

(* ds is the deleting spaces lens to be used*)
let name_prot (spaces:string) (ds:lens) = 
  xml_tag spaces  "name" (escape_name [;()[\]] ) . ds

let complete_name_prot (spaces:string) (ds:lens) = 
  let paren_name (dsp:lens) = 
    del "(" . name_prot spaces del_spaces . del ")" . dsp in
  (name_prot spaces "") . 
  ( (del_spaces_bis . (paren_name del_spaces_bis)* . (paren_name ds))
  | ds)

let special_name (tag:string) (spaces:string) (ds:lens) = 
  let name = complete_name_prot (spaces . "  ") ds in
  xml_opening_tag spaces  tag  .
  name . 
  xml_closing_tag spaces tag

let complete_special_name (tag:string) (flat_tag:string) = 
  let name = special_name tag "    " "" in
    del ("[" . flat_tag . ":") . del_spaces_bis . 
    (name . del_spaces .del ";" . del_spaces_bis)* .
      name . del_spaces . del "]"

    
let DE = 
  let name = complete_name_prot "    " "" in
  let name_includes  = complete_special_name "domain" "Includes" in
  let name_contains = complete_special_name "component" "Contains" in
    del_beg_line "DE" . xml_opening_tag "  " "protein" .name .
    (del_spaces_bis . name_includes)? .
    (del_spaces_bis . name_contains)? . 
    xml_closing_tag "  " "protein" . del ".\n"
    

test DE get 
<<<
DE   Arginine biosynthesis bifunctional protein argJ [Includes: Glutamate N-acetyltransferase (EC 2.3.1.35) (Ornithine acetyltransferase) (Ornithine transacetylase) (OATase); Amino-acid acetyltransferase (EC 2.3.1.1) (N-acetylglutamate synthase) (AGS)] [Contains: Arginine biosynthesis bifunctional protein argJ alpha chain; Arginine biosynthesis bifunctional protein argJ beta chain].

>>>
 = 
<<<  <protein>
    <name>Arginine biosynthesis bifunctional protein argJ</name>
    <domain>
      <name>Glutamate N-acetyltransferase</name>
      <name>EC 2.3.1.35</name>
      <name>Ornithine acetyltransferase</name>
      <name>Ornithine transacetylase</name>
      <name>OATase</name>
    </domain>
    <domain>
      <name>Amino-acid acetyltransferase</name>
      <name>EC 2.3.1.1</name>
      <name>N-acetylglutamate synthase</name>
      <name>AGS</name>
    </domain>
    <component>
      <name>Arginine biosynthesis bifunctional protein argJ alpha chain</name>
    </component>
    <component>
      <name>Arginine biosynthesis bifunctional protein argJ beta chain</name>
    </component>
  </protein>
>>>


(* check we deal well with spaces at creation *)
test DE create 
<<< <protein>
  <name>Arginine biosynthesis bifunctional protein argJ</name>
  <domain>
    <name>Glutamate N-acetyltransferase</name>
       <name>EC 2.3.1.35</name>
    <name>Ornithine acetyltransferase</name>   <name>Ornithine transacetylase</name>
    <name>OATase</name>
  </domain>
  <domain>
    <name>Amino-acid acetyltransferase</name>    <name>EC 2.3.1.1</name>
    <name>N-acetylglutamate synthase</name>
    <name>AGS</name>
  </domain>
  <component>    <name>Arginine biosynthesis bifunctional protein argJ alpha chain</name>
  </component>
  <component>    <name>Arginine biosynthesis bifunctional protein argJ beta chain</name>
  </component>    </protein>
>>>
=
<<<
DE   Arginine biosynthesis bifunctional protein argJ [Includes: Glutamate N-acetyltransferase (EC 2.3.1.35) (Ornithine acetyltransferase) (Ornithine transacetylase) (OATase); Amino-acid acetyltransferase (EC 2.3.1.1) (N-acetylglutamate synthase) (AGS)] [Contains: Arginine biosynthesis bifunctional protein argJ alpha chain; Arginine biosynthesis bifunctional protein argJ beta chain].

>>>



(****** GN line *******)


let gene_name = escape_name [,;]
    
let Name_gn = xml_tag_with_att "    " "name" (xml_simple_attribute "type" "primary") (del "Name=" . gene_name . del ";")

let complexe_gn_name (flat_tag:string) (tag:string) = 
  let attribute = xml_simple_attribute "type" tag in
    del (flat_tag . "=") . 
    (xml_tag_with_att "    " "name" attribute ( gene_name. del "," . del_spaces_bis))* .
    (xml_tag_with_att "    " "name" attribute ( gene_name. del ";"))

let Synonyms_gn = complexe_gn_name "Synonyms" "synonym"
let Ordered_locus_gn = complexe_gn_name "OrderedLocusNames"  "ordered locus"
let ORF_gn = complexe_gn_name "ORFNames" "ORF"

let GN_line = 
  let name_and_syn = Name_gn . (del_spaces_bis . Synonyms_gn)? in
  let olg = (name_and_syn . del_spaces_bis)? . Ordered_locus_gn in
  let orf = ((name_and_syn . del_spaces_bis) | (olg . del_spaces_bis))? . ORF_gn in
  xml_opening_tag "  " "gene" . del_beg_line "GN" . 
  (name_and_syn | olg | orf) . del "\n" .
  xml_closing_tag "  " "gene"


let GN = 
  GN_line . (del_beg_line "GN" . del "and" . del_spaces . del "\n" . GN_line)*


test GN get 
"GN   Name=Jon99Cii; Synonyms=SER1, SER5, Ser99Da; ORFNames=CG7877;
GN   and
GN   Name=Jon99Ciii; Synonyms=SER2, SER5, Ser99Db; ORFNames=CG15519;
GN   and
GN   OrderedLocusNames=b1237, c1701, z2013, ECs1739;
"
= 
<<<  <gene>
    <name type="primary">Jon99Cii</name>
    <name type="synonym">SER1</name>
    <name type="synonym">SER5</name>
    <name type="synonym">Ser99Da</name>
    <name type="ORF">CG7877</name>
  </gene>
  <gene>
    <name type="primary">Jon99Ciii</name>
    <name type="synonym">SER2</name>
    <name type="synonym">SER5</name>
    <name type="synonym">Ser99Db</name>
    <name type="ORF">CG15519</name>
  </gene>
  <gene>
    <name type="ordered locus">b1237</name>
    <name type="ordered locus">c1701</name>
    <name type="ordered locus">z2013</name>
    <name type="ordered locus">ECs1739</name>
  </gene>
>>>



(******* OS line ********)

(* ds is the deleting spaces lens to be used*)
let name_org (spaces:string) (ds:lens) (type:string) = 
  xml_tag_with_att spaces "name" (xml_simple_attribute "type" type) (escape_name [;()[\]])

let name_and_syn_org (spaces:string) = 
  name_org spaces "" "scientific" .
  (del_spaces_bis . del "(" . name_org spaces "" "common" . del ")".
  (del_spaces_bis . del "(" . name_org spaces "" "synonym" . del")")* )? . del ".\n"

let OS = 
  let spaces = "    " in
    del_beg_line "OS" . name_and_syn_org spaces 

test OS get 
"OS   Solanum lycopersicum (Tomato) (Lycopersicon esculentum).
" = 
<<<    <name type="scientific">Solanum lycopersicum</name>
    <name type="common">Tomato</name>
    <name type="synonym">Lycopersicon esculentum</name>
>>>


(***** OG line ******)
let name_plas  = 
  xml_opening_tag_with_att "  " "geneLocation" (xml_simple_attribute "type" "plasmid" . xml_os) .
  xml_tag "    " "name" (del "Plasmid " . del_spaces . escape_name [,]) .
  xml_closing_tag "  " "geneLocation"

let Plas_line = 
  del_beg_line "OG".
  name_plas .
  ( (del "," . del_spaces_bis . name_plas)* . 
     del "," . del_spaces_bis . del "and" . del_spaces_bis . name_plas)? . 
  del ".\n"


let OG_other_lines = 
  del_beg_line "OG" . 
  xml_spaces "  " . ins "<geneLocation type=\"" .
  ( "Hydrogenosome." <-> "hydrogenosome"
  | "Mitochondrion." <-> "mitochondrion"
  | "Nucleomorph." <-> "nucleomorph"
  | "Plastid." <-> "plastid"
  | "Plastid; Apicoplast." <-> "apicoplast"
  | "Plastid; Chloroplast." <-> "chloroplast"
  | "Plastid; Cyanelle." <-> "cyanelle"
  | "Plastid; Non-photosynthetic plastid." <-> "non-photosynthetic plastid").
  ins "\"/>\n" . del "\n"

let OG = Plas_line | OG_other_lines

test OG get 
<<<
OG   Plasmid R6-5, Plasmid IncFII R100 (NR1), and Plasmid IncFII R1-19 (R1 drd-19).

>>> =
<<<  <geneLocation type="plasmid">
    <name>R6-5</name>
  </geneLocation>
  <geneLocation type="plasmid">
    <name>IncFII R100 (NR1)</name>
  </geneLocation>
  <geneLocation type="plasmid">
    <name>IncFII R1-19 (R1 drd-19)</name>
  </geneLocation>
>>>

test OG create
<<<  <geneLocation type="non-photosynthetic plastid"/>
>>> = 
"OG   Plastid; Non-photosynthetic plastid.
"


(***** OC line ******)
let name_taxo =
  xml_tag "      " "taxon" (escape_name [;])

let OC = 
  del_beg_line "OC" .
  xml_opening_tag "    " "lineage" .
  (name_taxo . del ";". del_spaces_bis)* .
  name_taxo . del ".\n" .
  xml_closing_tag "    " "lineage"

test OC get 
<<<
OC   Eukaryota; Alveolata; Apicomplexa; Aconoidasida; Piroplasmida; Theileriidae; Theileria.

>>>
=
<<<    <lineage>
      <taxon>Eukaryota</taxon>
      <taxon>Alveolata</taxon>
      <taxon>Apicomplexa</taxon>
      <taxon>Aconoidasida</taxon>
      <taxon>Piroplasmida</taxon>
      <taxon>Theileriidae</taxon>
      <taxon>Theileria</taxon>
    </lineage>
>>>


(****** the OX line ****)

(* only one DB has been found in the 1.2GB flat file *)

(* XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX*)
(* still the problem of the key="i" where i is incremented 

   by default, it is replaced everywhere by 1. We use a q-lense to be
   able to accept on the abstract side a version with another number
*)
  (* XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX*)


let OX = 
  del_beg_line "OX" . del "NCBI_TaxID=" . 
  xml_begin_open_tag "    " "dbReference" .
  xml_concat_attributes 
    (xml_simple_attribute "type" "NCBI Taxonomy")
    (xml_attribute "key" qone " ") .
  xml_attribute "id" ([0-9]* ) "" . 
  xml_sgt . xml_nl . 
  del ";\n"

test OX get 
<<<OX   NCBI_TaxID=5874;
>>>
=
<<<    <dbReference type="NCBI Taxonomy" key="1" id="5874"/>
>>>

test OX create 
<<<<dbReference type="NCBI Taxonomy" key="42" id="5874"/>


>>> = 
<<<OX   NCBI_TaxID=5874;
>>>


(***** OH line *****)

let one_OH_line = 
  del_beg_line "OH" . xml_opening_tag_with_att "  " "organism" (xml_attribute "key" qone "") .
  ( (del "NCBI_TaxID=" .
     xml_begin_open_tag "    " "dbReference" . 
     xml_concat_attributes 
       (xml_simple_attribute "type" "NCBI Taxonomy")
       (xml_attribute "key" qone " ") .
     xml_attribute "id" ([0-9]* . del ";") "" . xml_sgt . xml_nl . del_spaces_bis)
   ~ (name_and_syn_org "    ")) . 
  xml_closing_tag "  " "organism" 


let OH = one_OH_line+

test OH get 
<<<
OH   NCBI_TaxID=9481; Callithrix.
OH   NCBI_TaxID=9536; Cercopithecus hamlyni (Owl-faced monkey) (Hamlyn's monkey).

>>> = 
<<<  <organism key="1">
    <name type="scientific">Callithrix</name>
    <dbReference type="NCBI Taxonomy" key="1" id="9481"/>
  </organism>
  <organism key="1">
    <name type="scientific">Cercopithecus hamlyni</name>
    <name type="common">Owl-faced monkey</name>
    <name type="synonym">Hamlyn's monkey</name>
    <dbReference type="NCBI Taxonomy" key="1" id="9536"/>
  </organism>
>>>


(**** the OS OG OC OX OH bloc ****)

let OS_OG_OC_OX_OH = 
 xml_opening_tag_with_att "  " "organism" (xml_attribute "key" qone "") . 
 OS . ( OG? ~ ((OC? ~ OX) . xml_closing_tag "  " "organism" . OH? ))

test OS_OG_OC_OX_OH get 
<<<
  OS   Solanum melongena (Eggplant) (Aubergine).
  OG   Plastid; Apicoplast.
  OC   Mammalia; Eutheria.
  OX   NCBI_TaxID=9606;
  OH   NCBI_TaxID=9481; Callithrix.
  OH   NCBI_TaxID=9536; Cercopithecus hamlyni (Owl-faced monkey) (Hamlyn's monkey).

>>> = 
<<<  <organism key="1">
    <name type="scientific">Solanum melongena</name>
    <name type="common">Eggplant</name>
    <name type="synonym">Aubergine</name>
    <dbReference type="NCBI Taxonomy" key="1" id="9606"/>
    <lineage>
      <taxon>Mammalia</taxon>
      <taxon>Eutheria</taxon>
    </lineage>
  </organism>
  <organism key="1">
    <name type="scientific">Callithrix</name>
    <dbReference type="NCBI Taxonomy" key="1" id="9481"/>
  </organism>
  <organism key="1">
    <name type="scientific">Cercopithecus hamlyni</name>
    <name type="common">Owl-faced monkey</name>
    <name type="synonym">Hamlyn's monkey</name>
    <dbReference type="NCBI Taxonomy" key="1" id="9536"/>
  </organism>
  <geneLocation type="apicoplast"/>
>>>





(**** reference lines ****)

(* this number is replaced in the abstract by the "key", 
 * wich is different since it is incremented from the begining of
 * the proteine for each tag with a key attribute. I decided to keep it
 * to centralise the external treatment of "key" in the abstract*)
let RN = 
  del_beg_line "RN" . del "[".
  xml_begin_open_tag "  " "reference" . 
  xml_attribute "key" (default ([0-9]* ) "1") "" . xml_gt . xml_nl .del"]\n"

let RP = 
  del_beg_line "RP" .
  xml_tag "    " "scope" (escape_name "") . del ".\n"


let RC = 
  let n = escape_name [,;] in
  let name (tag:string) = xml_tag "      " tag n in
  let global (tag:string) (flat_tag:string) = 
    let global_name = name tag in
      del (flat_tag . "=") . ((global_name . del "," . del_spaces_bis)+ . 
      del "and" . del_spaces_bis )? . global_name . del ";" in
  let strain = global "strain" "STRAIN" in
  let tissue = global "tissue" "TISSUE" in
  let plasmid = global "plasmid" "PLASMID" in
  let transposon = global "transposon" "TRANSPOSON" in
  let final_plasmid = (strain . del_spaces_bis)? . plasmid in
  let final_transposon = ((strain | final_plasmid) . del_spaces_bis)? . transposon in
  let final_tissue = ((strain | final_plasmid | final_transposon) . del_spaces_bis)? . tissue in
  let all = strain | final_plasmid | final_transposon | final_tissue in
  del_beg_line "RC" . xml_opening_tag "    " "source" . 
     all . del "\n" . xml_closing_tag "    " "source"


test RC get 
<<<RC   STRAIN=AL.012, AZ.026, AZ.180, DC.005, GA.039, GA2181, IL.014, and IL2.17;
>>>
=
<<<    <source>
      <strain>AL.012</strain>
      <strain>AZ.026</strain>
      <strain>AZ.180</strain>
      <strain>DC.005</strain>
      <strain>GA.039</strain>
      <strain>GA2181</strain>
      <strain>IL.014</strain>
      <strain>IL2.17</strain>
    </source>
>>>



test RC create 
<<<    <source>
      <plasmid>R1 (R7268)</plasmid>
      <transposon>Tn3</transposon>
    </source>
>>>

=
<<<RC   PLASMID=R1 (R7268); TRANSPOSON=Tn3;
>>>



let RX = 
  let name = escape_name [;] in
  let aux (tag:string) = 
    del (tag . "=") . 
    xml_begin_open_tag "      " "dbReference".
    xml_concat_attributes 
      (xml_simple_attribute "type" tag)
      (xml_attribute "key" qone " ") .
    xml_attribute "id" name "". xml_sgt. xml_nl . del ";" in
  let medline = aux "MEDLINE" in
  let pubmed = aux "PubMed" in
  let doi = aux "DOI" in
  let final_pub = (medline . del_spaces_bis)? . pubmed in
  let final_doi = ((medline | final_pub) .del_spaces_bis)? ~ doi in
  let all = (medline | final_pub | final_doi) in
    del_beg_line "RX" . all . del"\n"

test RX get 
<<<RX   MEDLINE=90158697; PubMed=1689460; DOI=10.1016/0166-6851(90)90007-9;
>>>
=
<<<      <dbReference type="DOI" key="1" id="10.1016/0166-6851(90)90007-9"/>
      <dbReference type="MEDLINE" key="1" id="90158697"/>
      <dbReference type="PubMed" key="1" id="1689460"/>
>>>


let RG = 
  let one_cons = 
    xml_tag_with_single_att "        " "consortium" "name" (escape_name [;]). del ";" in	
  del_beg_line "RG" . 
    (one_cons . del_spaces_bis)* . one_cons . del "\n"

test RG get
<<<RG   The C. elegans sequencing consortium;
>>>
=
<<<        <consortium name="The C. elegans sequencing consortium"/>
>>>


let RA = 
  let auth = 
    xml_tag_with_single_att "        " "person" "name" (escape_name [,;]) in
  del_beg_line "RA" . (auth . del "," . del_spaces_bis)* . auth . del";\n"


let RG_RA = 
  xml_opening_tag "      " "authorList" .
    (RG | (RG? . RA)) .
  xml_closing_tag "      " "authorList"

test RG_RA get 
<<<RA   Iams K.P., Young J.R., Nene V., Desai J., Webster P., Ole-Moiyoi O.K., Musoke A.J.;
>>>
=
<<<      <authorList>
        <person name="Iams K.P."/>
        <person name="Young J.R."/>
        <person name="Nene V."/>
        <person name="Desai J."/>
        <person name="Webster P."/>
        <person name="Ole-Moiyoi O.K."/>
        <person name="Musoke A.J."/>
      </authorList>
>>>

test RG_RA create 
<<<      <authorList>
        <consortium name="The C. elegans sequencing consortium"/>
        <person name="Iams K.P."/>
        <person name="Young J.R."/>
        <person name="Nene V."/>
        <person name="Desai J."/>
        <person name="Webster P."/>
        <person name="Ole-Moiyoi O.K."/>
        <person name="Musoke A.J."/>
      </authorList>
>>> = 
<<<
RG   The C. elegans sequencing consortium;
RA   Iams K.P., Young J.R., Nene V., Desai J., Webster P., Ole-Moiyoi O.K., Musoke A.J.;

>>>


let RT = 
  del_beg_line "RT" . del "\"" . xml_tag "      " "title" (escape_name "\"") . del "\";\n"

test RT get 
<<<RT   "Regulation of nitrogen metabolism in Bacillus subtilis: vive la difference!";
>>> = 
<<<      <title>Regulation of nitrogen metabolism in Bacillus subtilis: vive la difference!</title>
>>>


(***** RL line ******)

let journal_citation =
  let esc = xml_esc [:] in
  let esc_no_par = xml_esc [:( ] in	(* only electronique publications begin with "(" *)
  let esc_space = xml_esc [: ] in
  let name = 
    (esc_no_par . esc* . esc_space) (* a long string wich begin and end with a non space char *)
  | esc_space in  (* or an (improbable) single char string *)
  let number = default [0-9]* "0" in
  let year = [0-9]{4} in
  xml_begin_open_tag "    " "citation" . 
  xml_simple_attribute "type" "journal article" . xml_space. 
  xml_attribute "name" name " " . del " " . del_spaces .
  xml_attribute "volume" number " " . del ":" .
  xml_attribute "first" number " " . del "-" .
  xml_attribute "last" number " " .
  del "(" . xml_attribute "date" year "" . del ").\n" . xml_gt . xml_nl


(* to deal with the particular cases of electronique publication wich creates a "locator" tag... *)

let pgr = 
  del_beg_line "RL" . del "(er) Plant Gene Register" . del_spaces_bis .
  xml_tag "      " "locator" (escape_name [\n]). del ".\n"

let mbg = 
  del_beg_line "RL" . del "(er) Worm Breeder's Gazette" . del_spaces_bis . 
  xml_tag "      " "locator" (escape_name [\n]). del ".\n"


(*** in the 1.4 GB file, there are 6 examples of electronique publications 
     in other places than PGR and WBG : 
RL   (er) BMC Genomics 8:18(2007).
RL   (er) J. Med. Genet. 41:e46-e46(2004).
RL   (er) BMC Genomics 8:18(2007).
RL   (er) BMC Genomics 8:18(2007).
RL   (er) AfCS-Nature Molecule Pages (2004).
RL   (er) Invest. Ophthalmol. Vis. Sci. 43:ARVO E-Abstract 791(2002).

*)

(*XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX*)
(* here is a limitation. We don't escape the content, because it's prety hard to write
 * "from scratch" the regexp ([^ \n].[^\n]* ) - (("Worm Breeder's Gazette" | "Plant Gene Register"). [^\n]* )
 * with the xml escaping. So we don't allow "\"" to figure in the string*)
(*XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX*)

let electro = 
  del "(er)" . del_spaces_bis . 
  xml_begin_open_tag "    " "citation" . 
  xml_simple_attribute "type" "online journal article" .
  xml_attribute "name" (([^ \n""].[^\n""]* ) - (("Worm Breeder's Gazette" | "Plant Gene Register"). [^\n""]* )) "".
  xml_gt . xml_nl . del ".\n"


let book =
  let number = default [0-9]* "0" in
  let year = [0-9]{4} in
  let editor =
    xml_tag_with_single_att "        " "person" "name" (escape_name [,;]) in
  let editors = 
    xml_opening_tag "       " "editorList" . 
    (editor . del "," . del_spaces_bis)* .
    editor. del_spaces_bis . del "(eds.);" in
  let title = 
    xml_attribute "name" (escape_name "\"") "" . xml_gt . xml_nl . del "\n"in
  let rest = 
    del "," . del_spaces_bis . del "pp." .
    xml_begin_open_tag "    " "citation" . 
    (xml_attribute "volume" number " " . del ":")? .
    xml_attribute "first" number " " .  del "-" .
    xml_attribute "last" number " " . del"," . del_spaces_bis . 
    xml_attribute "publisher" (escape_name ["",]) " " . del "," . del_spaces_bis . 
    xml_attribute "city" (escape_name [,""]) " " . del " " . del_spaces .
    xml_attribute "date" (del "(" . year . del ")") "" in
  del "(In)" . del_spaces_bis . (editors ~ (title ~ rest)) . del "\n"


    
let unpub = 
    del "Unpublished observations" . del_spaces_bis . 
    xml_begin_open_tag "    " "citation" . 
    xml_simple_attribute "type" "unpublished observations" . xml_space .
    xml_attribute "date" partial_date  "". xml_gt . xml_nl . del "\n"

let thesis = 
  del "Thesis" . del_spaces_bis .
  xml_begin_open_tag "    " "citation" . 
  xml_simple_attribute "type" "thesis" . xml_space .
  xml_attribute "date" (del "(" . [0-9]{4} . del "),") " ". del_spaces_bis .
  xml_attribute "institute" (escape_name "\"") " " . del "," . del_spaces_bis .
  xml_attribute "country" (escape_name [,:""]) "" . del ".\n" . (* countries 
								 * are not alowed to contain : to avoid 
								 * ambiguity with journal citation... *)
  xml_gt . xml_nl


let patent = 
  del "Patent number" . del_spaces_bis . 
  xml_begin_open_tag "    " "citation" . 
  xml_simple_attribute "type" "patent" . xml_space . 
  xml_attribute "number" (escape_name "\"") " " . del "," . del_spaces_bis . 
  xml_attribute "date" (del "(" . date . del ")") "" . del ".\n" . xml_gt . xml_nl


let submited = 
  del "Submitted" . del_spaces_bis . 
  xml_begin_open_tag "    " "citation" . 
  xml_simple_attribute "type" "submission" . xml_space . 
  xml_attribute "date" (del "(" . partial_date . del ")") " " . del_spaces_bis . del "to " .
  xml_attribute "db" ("Swiss-Prot" 
                 | (del "the " . ( "EMBL/GenBank/DDBJ databases" 
		                 | "PIR data bank" 
				 | "PDB data bank"))) "". 
  xml_gt . xml_nl . del ".\n"

(*** !!!!! pgr and mbg has to be treated separatly !!! ****)
let RL = 
  del_beg_line "RL" .
  ( journal_citation | electro | book | unpub | thesis | patent | submited )

let Rlines = 
  let RP_RC_RX = (RP . RC?) ~ (RX? . xml_closing_tag "    " "citation") in 
  let RG_RA_RT = RG_RA ~ RT? in
  (RN . 
    (
      (RP_RC_RX ~ ((RG_RA ~ RT?)  ~ RL)) 
    | (xml_spaces "    " . ins "<citation type=\"online journal article\" name=\"Plant Gene Register\">\n" .
       (RP_RC_RX ~ (RG_RA_RT . pgr)))
    | (xml_spaces "    " . ins "<citation type=\"online journal article\" name=\"Worm Breeder's Gazette\">\n" .
       (RP_RC_RX ~ (RG_RA_RT . mbg)))
    ).
    xml_closing_tag "  " "reference")*



test Rlines get 
<<<
RN   [1]
RP   NUCLEOTIDE SEQUENCE [LARGE SCALE GENOMIC DNA].
RC   STRAIN=Ankara;
RX   PubMed=15994557; DOI=10.1126/science.1110418;
RA   Pain A., Renauld H.;
RT   "Genome of the host-cell transforming parasite Theileria annulata compared with T. parva.";
RL   Science 309:131-133(2005).

>>> = 
<<<  <reference key="1">
    <citation type="journal article" name="Science" volume="309" first="131" last="133" date="2005">
      <title>Genome of the host-cell transforming parasite Theileria annulata compared with T. parva.</title>
      <authorList>
        <person name="Pain A."/>
        <person name="Renauld H."/>
      </authorList>
      <dbReference type="DOI" key="1" id="10.1126/science.1110418"/>
      <dbReference type="PubMed" key="1" id="15994557"/>
    </citation>
    <scope>NUCLEOTIDE SEQUENCE [LARGE SCALE GENOMIC DNA]</scope>
    <source>
      <strain>Ankara</strain>
    </source>
  </reference>
>>>


test Rlines get
<<<
RN   [1]
RP   NUCLEOTIDE SEQUENCE [GENOMIC DNA].
RC   STRAIN=cv. Resnik; TISSUE=Leaf;
RA   Reverdatto S.V., Beilinson V., Nielsen N.C.;
RT   "The rps16, accD, psaI, ORF 203, ORF 151, ORF 103, ORF 229 and petA gene cluster in the chloroplast genome of soybean.";
RL   (er) Plant Gene Register PGR95-051.

>>>
=
<<<  <reference key="1">
    <citation type="online journal article" name="Plant Gene Register">
      <title>The rps16, accD, psaI, ORF 203, ORF 151, ORF 103, ORF 229 and petA gene cluster in the chloroplast genome of soybean.</title>
      <authorList>
        <person name="Reverdatto S.V."/>
        <person name="Beilinson V."/>
        <person name="Nielsen N.C."/>
      </authorList>
      <locator>PGR95-051</locator>
    </citation>
    <scope>NUCLEOTIDE SEQUENCE [GENOMIC DNA]</scope>
    <source>
      <strain>cv. Resnik</strain>
      <tissue>Leaf</tissue>
    </source>
  </reference>
>>>

(****** CC line ******)
(* New pb with strong composition type : I would like to filter
 * strings that do not finish with "(By similarity)" and/or 
 * do not contain Note:. But for that, I can't just compose with the
 * habitual xml filter since the expected type is a "star type". It's
 * possible to build by hand the entire regexp, but I choose here to 
 * banish <> and & from comentaries for now. To be fixed *)

let ends_of_CC = 
  ( "(By similarity)"
  | "(Potential)"
  | "(Probable)" )

let CC_content_type =
  let chars = [^<>&\n]* in
    (chars - (" ".chars| chars." " | "" | chars . ";"))-
         ( 
           (chars . "Note=" . chars) |
           ( chars . ends_of_CC))

let CC_content = 
  xml_opening_tag_no_nl "    " "text" . 
  CC_content_type . 
  xml_closing_tag "" "text"

let note = 
  del_spaces_bis . del "Note=" . 
  xml_opening_tag_no_nl "    " "note" . 
    CC_content_type . 
  xml_closing_tag "" "note"

let eoC = 
  del_spaces_bis . xml_space . 
  xml_attribute "status"  
    ( "(By similarity)" <-> "By similarity"
    | "(Potential)" <-> "Potential"
    | "(Probable)" <-> "Probable" ) ""

let classic_CC_lines (corres:lens) = 
  del_beg_line "CC" . del "-!-" . del_spaces_bis .
  xml_begin_open_tag "  " "comment" . 
  xml_attribute_no_space "type" corres . 
  del ":" . del_spaces_bis .
  ((CC_content . note?) ~ (eoC? . xml_gt . xml_nl)).
  xml_closing_tag "  " "comment" . del ".\n"

let corres_allergen = 
    "ALLERGEN" <-> "allergen"

let CC_allergen = 
  classic_CC_lines corres_allergen

let corres_biotech_to_induc =
  ( "BIOTECHNOLOGY" <-> "biotechnology"
  | "CATALYTIC ACTIVITY" <-> "catalytic activity"
  | "COFACTOR" <-> "cofactor"
  | "DEVELOPMENTAL STAGE" <-> "developmental stage"
  | "DISEASE" <-> "disease"
  | "DOMAIN" <-> "domain"
  | "ENZYME REGULATION" <-> "enzyme regulation"
  | "FUNCTION" <-> "function"
  | "INDUCTION" <-> "induction" )

let CC_biotech_to_induc = 
  classic_CC_lines corres_biotech_to_induc


let corres_misc_to_rna = 
  ( "MISCELLANEOUS" <-> "miscellaneous"
  | "PATHWAY" <-> "pathway"
  | "PHARMACEUTICAL" <-> "pharmaceutical"
  | "POLYMORPHISM" <-> "polymorphism"
  | "PTM" <-> "PTM"
  | "RNA EDITING" <-> "RNA editing" )

let CC_misc_to_rna = 
  classic_CC_lines corres_misc_to_rna


let corres_simi_to_toxic = 
  ( "SIMILARITY" <-> "similarity"
  | "SUBCELLULAR LOCATION" <-> "subcellular location"
  | "SUBUNIT" <-> "subunit"
  | "TISSUE SPECIFICITY" <-> "tissue specificity"
  | "TOXIC DOSE" <-> "toxic dose" )

let CC_simi_to_toxic =
  classic_CC_lines corres_simi_to_toxic


test CC_simi_to_toxic get 
<<<CC   -!- SUBCELLULAR LOCATION: Cell membrane; lipid-anchor; GPI-anchor (Potential). Note=In microneme/rhoptry complexes (By similarity).
>>>
= 
<<<  <comment type="subcellular location" status="By similarity">
    <text>Cell membrane; lipid-anchor; GPI-anchor (Potential).</text>
    <note>In microneme/rhoptry complexes</note>
  </comment>
>>>

let biophy_prop = 
  let content = escape_name [\n;] in
  let absorption = 
    del "Absorption:" . del_spaces_bis .
    xml_opening_tag "    " "absorption" .
    xml_tag "      " "max" (del "Abs(max)=" . content . del";") . del_spaces_bis .
    xml_tag "      " "text" (del "Note=" . content . del";"). del_spaces_bis .
    xml_closing_tag "    " "absorption" in 
  let kinet_param = 
    del "Kinetic parameters:" . del_spaces_bis .
    xml_opening_tag "    " "kinetics" .
    xml_tag "      " "KM" (del "KM=" . content . del";") . del_spaces_bis .
    xml_tag "      " "Vmax" (del "Vmax=" . content . del";") . del_spaces_bis . 
    xml_tag "      " "text" (del "Note=" . content . del";") .  del_spaces_bis .
    xml_closing_tag "    " "kinetics" in
  let free_text (flat_tag:string) (xtag:string) = 
    del (flat_tag . ":") . del_spaces_bis . 
    xml_tag "    " xtag content . del ";" .del_spaces_bis in
  let ph_dep = free_text "pH dependence" "phDependence" in
  let red_pot = free_text "Redox potential" "redoxPotential" in
  let temp_dep = free_text "Temperature dependence" "temperatureDependence" in
  del_beg_line "CC" . del "-!- BIOPHYSICOCHEMICAL PROPERTIES:" . del_spaces_bis . 
  xml_opening_tag_with_att "  " "comment" (xml_simple_attribute "type" "biophysicochemical properties") .
  absorption? . kinet_param? . ph_dep? . red_pot? . temp_dep? . 
  xml_closing_tag "  " "comment" . del "\n"


test biophy_prop get
<<<CC   -!- BIOPHYSICOCHEMICAL PROPERTIES: Absorption: Abs(max)=465 nm; Note=The above maximum is for the oxidized form. Shows a maximal peak at 330 nm in the reduced form. These absorption peaks are for the tryptophylquinone cofactor; Kinetic parameters: KM=5.4 uM for tyramine; Vmax=17 umol/min/mg enzyme; Note=The enzyme is substrate inhibited at high substrate concentrations (Ki=1.08 mM for tyramine);
>>> = 
<<<  <comment type="biophysicochemical properties">
    <absorption>
      <max>465 nm</max>
      <text>The above maximum is for the oxidized form. Shows a maximal peak at 330 nm in the reduced form. These absorption peaks are for the tryptophylquinone cofactor</text>
    </absorption>
    <kinetics>
      <KM>5.4 uM for tyramine</KM>
      <Vmax>17 umol/min/mg enzyme</Vmax>
      <text>The enzyme is substrate inhibited at high substrate concentrations (Ki=1.08 mM for tyramine)</text>
    </kinetics>
  </comment>
>>>


let interaction = 
  let id = escape_name [\n:;] in
  let esc = xml_esc [\n;()] in
  let esc_no_dash = xml_esc [\n; \-()] in
  let esc_space = xml_esc [\n; ()] in
  let label = 
    (esc_space . esc* . esc_space) (* a long string wich begin and end with a non space char *)
  | esc_no_dash in  (* or an (improbable) single char string *)
  let prot = escape_name [\n,;""] in
  let inter = 
    xml_opening_tag_with_att "  " "comment" (xml_simple_attribute "type" "interaction") .
    (((( xml_gt . xml_nl .
      xml_tag "      " "id" id . del ":" .
      (xml_tag "      " "label" label | del "-") .
      xml_closing_tag "    " "interactant".
      xml_tag "    " "organismsDiffer" 
              ("" <-> "false"
	      |" (xeno)" <-> "true" ))
    | xml_sgt . xml_nl . xml_tag "    " "organismsDiffer" ("Self" <-> "false")).
    del "; " .
    xml_tag "    " "experiments" (del "NbExp=" . [0-9]+ .del "; ")) ~
    (del "IntAct=" . xml_tag_with_single_att "    " "interactant" "intactId" prot .
     del ", " . 
     xml_begin_open_tag "    " "interactant" . 
     xml_attribute "intactId" prot "" )). del ";" . 
    xml_closing_tag "  " "comment" in
  del_beg_line "CC" . del "-!- INTERACTION:" . del_spaces_bis .
  (inter . del_spaces_bis)* . inter . del "\n"



test interaction get 
<<<CC   -!- INTERACTION: Self; NbExp=1; IntAct=EBI-1043398, EBI-1043398; Q8NBH6:-; NbExp=1; IntAct=EBI-1043398, EBI-1050185; P21266:GSTM3; NbExp=1; IntAct=EBI-1043398, EBI-350350;
>>> = 
<<<  <comment type="interaction">
    <interactant intactId="EBI-1043398"/>
    <interactant intactId="EBI-1043398"/>
    <organismsDiffer>false</organismsDiffer>
    <experiments>1</experiments>
  </comment>
  <comment type="interaction">
    <interactant intactId="EBI-1043398"/>
    <interactant intactId="EBI-1050185">
      <id>Q8NBH6</id>
    </interactant>
    <organismsDiffer>false</organismsDiffer>
    <experiments>1</experiments>
  </comment>
  <comment type="interaction">
    <interactant intactId="EBI-1043398"/>
    <interactant intactId="EBI-350350">
      <id>P21266</id>
      <label>GSTM3</label>
    </interactant>
    <organismsDiffer>false</organismsDiffer>
    <experiments>1</experiments>
  </comment>
>>>

	      
let alt_prod = 
  let event = 
    xml_tag_with_single_att "    " "event" "type" 
       ( "Alternative promoter usage" <-> "alternative promoter"
       | "Alternative splicing" <-> "alternative splicing"
       | "Alternative initiation" <-> "alternative initiation"
       | "Ribosomal frameshifting" <-> "ribosomal frameshifting") in
  let events = 
    del "Event=" . (event . del "," . del_spaces_bis)* . 
    event . del "; Named isoforms=" . del [0-9]* . del ";" . del_spaces_bis in
  let comment = 
    del "Comment=" .
    xml_tag "    " "comment" (escape_name [\n;]) . del ";" . del_spaces_bis in
  let syno = 
    let syno_name = xml_tag "      " "name" (escape_name [\n,;]) in
    del "Synonyms=" . (syno_name . del "," .del_spaces_bis)*. syno_name . del ";" . del_spaces_bis in
  let name = 
    let sequence = 
      del "Sequence=" .
      (xml_tag_with_single_att "      " "sequence" "type" 
             ("Displayed" <-> "displayed"
	     | "External" <-> "external"
	     | "Not described" <-> "not described")
      | (xml_begin_open_tag "      " "sequence" . 
	 xml_simple_attribute "type" "described" . xml_space .
	 xml_attribute "ref" (("VSP_" . [0-9]*. del"," . " ")* . "VSP_" . [0-9]* ) "" .
	xml_sgt . xml_nl)) .del ";" in
    xml_opening_tag "    " "isoform" . 
    ((xml_tag "      " "name" (del "Name=" . [0-9]+ . del ";") . del_spaces_bis .
      syno?
     ) ~
     (xml_tag "      " "id" (del "IsoId=" . escape_name [\n;]. del ";") . del_spaces_bis)) .
    sequence .
    (del_spaces_bis . xml_tag "      " "note" (del "Note=" . escape_name [\n;] . del ";"))?.
    xml_closing_tag "    " "isoform" in
  del_beg_line "CC" . del "-!- ALTERNATIVE PRODUCTS:" . del_spaces_bis .
  xml_opening_tag_with_att "  " "comment" (xml_simple_attribute "type" "alternative products") . 
  events . comment? . (name . del_spaces_bis)* . name . 
  xml_closing_tag "  " "comment" . del "\n"


test alt_prod get
<<<CC   -!- ALTERNATIVE PRODUCTS: Event=Alternative splicing; Named isoforms=2; Name=1; Synonyms=D, E; IsoId=P48347-1; Sequence=Displayed; Name=2; IsoId=P48347-2; Sequence=VSP_008972;
>>>
=
<<<  <comment type="alternative products">
    <event type="alternative splicing"/>
    <isoform>
      <id>P48347-1</id>
      <name>1</name>
      <name>D</name>
      <name>E</name>
      <sequence type="displayed"/>
    </isoform>
    <isoform>
      <id>P48347-2</id>
      <name>2</name>
      <sequence type="described" ref="VSP_008972"/>
    </isoform>
  </comment>
>>>



let mass_spec = 
  let num = ([0-9]* . ("." . [0-9]* )?) in
  del_beg_line "CC" . del "-!- MASS SPECTROMETRY:" . del_spaces_bis . 
  xml_begin_open_tag "  " "comment" . xml_simple_attribute "type" "mass spectrometry" . xml_space .
  del "MW=" . xml_attribute "mass" num " " . del ";" .del_spaces_bis.
  (del "MW_ERR=". xml_attribute "error" num  " " . del ";" . del_spaces_bis)? .
  del "METHOD=" . xml_attribute "method" (escape_name [\n;""]) "" . del ";" . del_spaces_bis. xml_gt . xml_nl .
  xml_opening_tag "    " "location" . del "RANGE=".
  ( (del "?" . xml_tag_with_single_att "      " "begin" "status" (ins "unknown")) 
  | (xml_tag_with_single_att "      " "begin" "position" num)).
  del "-" .
  ( (del "?" . xml_tag_with_single_att "      " "end" "status" (ins "unknown"))
  | (xml_tag_with_single_att "      " "end" "position" num )).
  xml_closing_tag "    " "location".
  del ";" . del_spaces_bis . del "NOTE=" .
  xml_tag "    " "note" (escape_name [\n""]).
  xml_closing_tag "  " "comment". del".\n"

test mass_spec get 
<<<CC   -!- MASS SPECTROMETRY: MW=29440; MW_ERR=2; METHOD=MALDI; RANGE=1-255; NOTE=Ref.2.
>>>
=
<<<  <comment type="mass spectrometry" mass="29440" error="2" method="MALDI">
    <location>
      <begin position="1"/>
      <end position="255"/>
    </location>
    <note>Ref.2</note>
  </comment>
>>>



let seq_caution =
  let content = escape_name [\n;] in
  let caution = 
    xml_opening_tag_with_att "  " "comment" (xml_simple_attribute "type" "caution").
    xml_opening_tag_no_nl "    " "text" .
    "Sequence=" . content. "; Type=" . content . ";" .
    (" Positions=" . content .";")? .
    (" Note=" . content . ";")? .
    xml_closing_tag "" "text" . 
    xml_closing_tag "  " "comment" in
    del_beg_line "CC" . del "-!- SEQUENCE CAUTION:" . del_spaces_bis .
      (caution . del_spaces_bis)* . caution . del"\n"


test seq_caution get 
<<<CC   -!- SEQUENCE CAUTION: Sequence=AAA25676.1; Type=Frameshift; Positions=Several; Sequence=CAD59919.1; Type=Frameshift; Positions=519;
>>> 
=
<<<  <comment type="caution">
    <text>Sequence=AAA25676.1; Type=Frameshift; Positions=Several;</text>
  </comment>
  <comment type="caution">
    <text>Sequence=CAD59919.1; Type=Frameshift; Positions=519;</text>
  </comment>
>>>


let web = 
  let content = escape_name [\n;] in
  del_beg_line "CC" . del "-!- WEB RESOURCE:" . del_spaces_bis .
  xml_begin_open_tag "  " "comment" . xml_simple_attribute "type" "online information" . xml_space .
  xml_attribute "name" (del "NAME=" . (escape_name [\n;""])) "" . xml_gt . xml_nl .
  (( del ";" . del_spaces_bis . xml_tag "    " "note" (del "NOTE=" . content))? ~
   ( del ";" . del_spaces_bis . del "URL=\"" . xml_tag_with_single_att "    " "link" "uri" content . del "\"")?).
  xml_closing_tag "  " "comment" . del ".\n"


test web get 
<<<CC   -!- WEB RESOURCE: NAME=GeneDis; NOTE=CAH; URL="http://life2.tau.ac.il/GeneDis/Tables/CAH/cah.html".
>>> = 
<<<  <comment type="online information" name="GeneDis">
    <link uri="http://life2.tau.ac.il/GeneDis/Tables/CAH/cah.html"/>
    <note>CAH</note>
  </comment>
>>>


let CC =
  CC_allergen? . alt_prod? . biophy_prop? .CC_biotech_to_induc*. interaction? .
  mass_spec* . CC_misc_to_rna* . seq_caution? . CC_simi_to_toxic* . web*


	   





(****** DR lines ******)


let content_DR = escape_name_diff [\n;""] "-"

let beg_DR (lst_db:regexp) = 
  xml_attribute "type" lst_db " ". del ";" . del_spaces_bis .
  xml_attribute "key" qone " ".
  xml_attribute "id" content_DR ""

let DR_property (type:string) = 
  del "; " . 
  xml_begin_open_tag "    " "property" . 
  xml_attribute "value" content_DR " " .
  xml_simple_attribute "type" type . xml_sgt . xml_nl

let optional_DR_2 (lst_db:regexp) (type:string) = 
  beg_DR lst_db . 
   ((del "; -" . xml_sgt . xml_nl) 
 | (xml_gt . xml_nl .
    DR_property type .
    xml_closing_tag "  " "dbReference"))

let optional_DR_3 (lst_db:regexp) (type1:string) (type2:string) = 
  beg_DR lst_db . 
    ((del "; -; -" . xml_sgt . xml_nl) 
  | (xml_gt . xml_nl . 
     ((DR_property type1 . (DR_property type2 | del "; -")) |(del "; -" . DR_property type2)).  
     xml_closing_tag "  " "dbReference"))

let optional_DR_4 (lst_db:regexp) (type1:string) (type2:string) (type3:string)= 
  beg_DR lst_db . 
    ((del "; -; -; -" . xml_sgt . xml_nl) 
  | (xml_gt . xml_nl . 
     (
       (DR_property type1 . (DR_property type2 | del "; -") . (DR_property type3 | del "; -")) 
      |(del "; -" . DR_property type2 . (DR_property type3 | del "; -"))
      |(del "; -; -" . DR_property type3 )).
     xml_closing_tag "  " "dbReference"))

let DR_2_1 =
  optional_DR_2 ( "HIV" | "InterPro" | "PIR" | "PRINTS" | "REBASE")
    "entry name"

let DR_2_1_3_1 =
  optional_DR_3 ("Gene3D" | "PANTHER" | "Pfam" 
  | "ProDom" | "SMART" | "TIGRFAMs") 
    "entry name" "match status"

let DR_2_2_3_3_4_1 = 
  optional_DR_4 "PDB" "method" "resolution" "chains"


(* !!! pb with HGNC ! the XML file has "entry name" instead of "gene designation" !!! *)
let DR_2_3 =
  optional_DR_2 ("DictyBase" | "EcoGene" | "FlyBase" | "HGNC" | "MGI" | "RGD" | "SGD" 
        | "StyGene" | "SubtiList" | "WormBase" | "ZFIN" ) "gene designation"

let DR_2_4_3_2 = 
  optional_DR_3 "GO" "term" "evidence"

(* look at DR   HAMAP; MF_01546; atypical; 1. *)
let DR_2_5_3_1 = 
  optional_DR_3 "HAMAP" "flag" "match status"

let DR_2_6 = 
  optional_DR_2 "ECO2DBASE" "edition"

let DR_2_7 = 
  optional_DR_2 ("Cornea-2DPAGE" | "DOSAC-COBS-2DPAGE" | "HSC-2DPAGE" | "REPRODUCTION-2DPAGE" 
        | "SWISS-2DPAGE") "organism name"

let DR_2_8 = 
  optional_DR_2 "Ensembl" "organism name"

let DR_2_9_3_1 = 
  optional_DR_3 "PIRSF" "entry name" "match status"
  

(* no AARHUS exemple found *)
(*let DR_2_10 = 
  optional_DR_2 "AARHUS/GHENT-2DPAGE" "" *)
  
let DR_2_11 = 
  optional_DR_2 "WormPep" "accession"
  
let DR_2_12 = 
  beg_DR ("AGD" | "ANU-2DPAGE" | "ArrayExpress" | "BioCyc" | "CleanEx" 
        | "COMPLUYEAST-2DPAGE" | "CYGD" | "DIP" | "DisProt" | "EchoBASE" 
	| "GeneDB_Spombe" | "GeneID" | "GlycoSuiteDB" | "Gramene" | "H-InvDB" 
	| "HPA" | "IntAct" | "KEGG" | "LegioList" | "Leproma" | "LinkHub" 
	| "ListiList" | "MaizeGDB" | "MEROPS" | "MypuList" | "OGP" | "PeptideAtlas" 
	| "PharmGKB" | "PHCI-2DPAGE" | "PhosSite" | "PhotoList" | "PMMA-2DPAGE" 
	| "PptaseDB" | "PseudoCAP" | "Rat-heart-2DPAGE" | "RefSeq" | "SagaList" 
	| "Siena-2DPAGE" | "TAIR" | "TIGR" | "TRANSFAC" | "TubercuList or UniGene") .
  del "; -" . xml_sgt . xml_nl

let DR_2_13 = 
  optional_DR_2 "HSSP" "PDB accession"
    
let DR_2_14 = 
  optional_DR_2 "GeneFarm" "family number"
    
let DR_2_15 = 
  optional_DR_2 "SMR" "residue range"
  
let DR_2_16 = 
  optional_DR_2 "MIM" "type"
  
(* for now, the second identifier seems to be dropped away. I'm waiting for an answer of the uniprot help list *)

(*let DR_2_17 = 
  optional_DR_2 "Orphanet" ""*)
  
let DR_2_18 = 
  optional_DR_2 "GenomeReviews" "gene designation"
  
let DR_2_19 = 
  optional_DR_2 "GermOnline" "organism name"
  
let DR_2_20 = 
  optional_DR_2 "PeroxiBase" "entry name"
  
let DR_2_21 = 
  optional_DR_2 "Reactome" "pathway name"
  
let DR_2_22 = 
  optional_DR_2 "DrugBank" "generic name"
  
let DR_EMBL = 
  optional_DR_4 "EMBL" "protein sequence ID" "status" "molecule type"

let DR_PROSITE = 
  optional_DR_3 "PROSITE" "entry name" "match status"

let DR = 
  del_beg_line "DR" . xml_begin_open_tag "  " "dbReference" . 
  (DR_2_1 | DR_2_1_3_1 | DR_2_2_3_3_4_1 | DR_2_3 | DR_2_4_3_2 | DR_2_5_3_1 
 | DR_2_6 | DR_2_7 | DR_2_8 | DR_2_9_3_1 | DR_2_11 | DR_2_12 | DR_2_13
 | DR_2_14 | DR_2_15 | DR_2_16 | DR_2_18 | DR_2_19 | DR_2_20 | DR_2_21 
 | DR_2_22 | DR_EMBL | DR_PROSITE).
  del ".\n"




test DR* get
<<<
   DR   EMBL; X83467; CAA58470.1; -; Genomic_DNA.
   DR   EMBL; X83468; CAA58470.1; JOINED; Genomic_DNA.
   DR   PROSITE; PS00940; GAMMA_THIONIN; 1.
   DR   EMBL; CR940353; CAI76474.1; -; Genomic_DNA.
   DR   KEGG; tan:TA08425; -.
   DR   InterPro; IPR007480; DUF529.
   DR   Pfam; PF04385; FAINT; 4.

>>> 
= 
<<<  <dbReference type="EMBL" key="1" id="X83467">
    <property value="CAA58470.1" type="protein sequence ID"/>
    <property value="Genomic_DNA" type="molecule type"/>
  </dbReference>
  <dbReference type="EMBL" key="1" id="X83468">
    <property value="CAA58470.1" type="protein sequence ID"/>
    <property value="JOINED" type="status"/>
    <property value="Genomic_DNA" type="molecule type"/>
  </dbReference>
  <dbReference type="PROSITE" key="1" id="PS00940">
    <property value="GAMMA_THIONIN" type="entry name"/>
    <property value="1" type="match status"/>
  </dbReference>
  <dbReference type="EMBL" key="1" id="CR940353">
    <property value="CAI76474.1" type="protein sequence ID"/>
    <property value="Genomic_DNA" type="molecule type"/>
  </dbReference>
  <dbReference type="KEGG" key="1" id="tan:TA08425"/>
  <dbReference type="InterPro" key="1" id="IPR007480">
    <property value="DUF529" type="entry name"/>
  </dbReference>
  <dbReference type="Pfam" key="1" id="PF04385">
    <property value="FAINT" type="entry name"/>
    <property value="4" type="match status"/>
  </dbReference>
>>>



(**** PE line ****)

let PE = 
  del_beg_line "PE" . 
  xml_tag_with_single_att "  " "proteinExistence" "type" 
    ( "1: Evidence at protein level" <-> "Evidence at protein level"
    | "2: Evidence at transcript level" <-> "Evidence at transcript level"
    | "3: Inferred from homology" <-> "Inferred from homology"
    | "4: Predicted" <-> "Predicted"
    | "5: Uncertain" <-> "Uncertain") .
  del ";\n"


test PE get 
<<<
    PE   3: Inferred from homology;

>>>
=
<<<  <proteinExistence type="Inferred from homology"/>
>>>

test PE create 
<<<  <proteinExistence type="Uncertain"/>
>>>
=
<<<
   PE   5: Uncertain;

>>>




(**** KW line ****)

(* correspondance betweed keywords and ids. *)

let corres_kw_id = 
  ( "2Fe-2S" <-> "KW-0001\">2Fe-2S"
  | "3D-structure" <-> "KW-0002\">3D-structure"
  | "3Fe-4S" <-> "KW-0003\">3Fe-4S"
  | "4Fe-4S" <-> "KW-0004\">4Fe-4S"
  | "Abscisic acid biosynthesis" <-> "KW-0937\">Abscisic acid biosynthesis"
  | "Abscisic acid signaling pathway" <-> "KW-0938\">Abscisic acid signaling pathway"
  | "Acetoin biosynthesis" <-> "KW-0005\">Acetoin biosynthesis"
  | "Acetoin catabolism" <-> "KW-0006\">Acetoin catabolism"
  | "Acetylation" <-> "KW-0007\">Acetylation"
  | "Acetylcholine receptor inhibitor" <-> "KW-0008\">Acetylcholine receptor inhibitor"
  | "Actin-binding" <-> "KW-0009\">Actin-binding"
  | "Actin capping" <-> "KW-0117\">Actin capping"
  | "Activator" <-> "KW-0010\">Activator"
  | "Acute phase" <-> "KW-0011\">Acute phase"
  | "Acyltransferase" <-> "KW-0012\">Acyltransferase"
  | "ADP-ribosylation" <-> "KW-0013\">ADP-ribosylation"
  | "Age-related macular degeneration" <-> "KW-0913\">Age-related macular degeneration"
  | "Aicardi-Goutieres syndrome" <-> "KW-0948\">Aicardi-Goutieres syndrome"
  | "AIDS" <-> "KW-0014\">AIDS"
  | "Albinism" <-> "KW-0015\">Albinism"
  | "Alginate biosynthesis" <-> "KW-0016\">Alginate biosynthesis"
  | "Alkaloid metabolism" <-> "KW-0017\">Alkaloid metabolism"
  | "Alkylphosphonate uptake" <-> "KW-0019\">Alkylphosphonate uptake"
  | "Allergen" <-> "KW-0020\">Allergen"
  | "Allosteric enzyme" <-> "KW-0021\">Allosteric enzyme"
  | "Alpha-amylase inhibitor" <-> "KW-0022\">Alpha-amylase inhibitor"
  | "Alport syndrome" <-> "KW-0023\">Alport syndrome"
  | "Alternative initiation" <-> "KW-0024\">Alternative initiation"
  | "Alternative promoter usage" <-> "KW-0877\">Alternative promoter usage"
  | "Alternative splicing" <-> "KW-0025\">Alternative splicing"
  | "Alzheimer disease" <-> "KW-0026\">Alzheimer disease"
  | "Amidation" <-> "KW-0027\">Amidation"
  | "Amino-acid biosynthesis" <-> "KW-0028\">Amino-acid biosynthesis"
  | "Amino-acid transport" <-> "KW-0029\">Amino-acid transport"
  | "Aminoacyl-tRNA synthetase" <-> "KW-0030\">Aminoacyl-tRNA synthetase"
  | "Aminopeptidase" <-> "KW-0031\">Aminopeptidase"
  | "Aminotransferase" <-> "KW-0032\">Aminotransferase"
  | "Ammonia transport" <-> "KW-0924\">Ammonia transport"
  | "Amphibian defense peptide" <-> "KW-0878\">Amphibian defense peptide"
  | "Amyloid" <-> "KW-0034\">Amyloid"
  | "Amyloplast" <-> "KW-0035\">Amyloplast"
  | "Amyotrophic lateral sclerosis" <-> "KW-0036\">Amyotrophic lateral sclerosis"
  | "Angiogenesis" <-> "KW-0037\">Angiogenesis"
  | "Anion exchange" <-> "KW-0039\">Anion exchange"
  | "ANK repeat" <-> "KW-0040\">ANK repeat"
  | "Annexin" <-> "KW-0041\">Annexin"
  | "Antenna complex" <-> "KW-0042\">Antenna complex"
  | "Antibiotic biosynthesis" <-> "KW-0045\">Antibiotic biosynthesis"
  | "Antibiotic" <-> "KW-0044\">Antibiotic"
  | "Antibiotic resistance" <-> "KW-0046\">Antibiotic resistance"
  | "Antifreeze protein" <-> "KW-0047\">Antifreeze protein"
  | "Antimicrobial" <-> "KW-0929\">Antimicrobial"
  | "Anti-oncogene" <-> "KW-0043\">Anti-oncogene"
  | "Antioxidant" <-> "KW-0049\">Antioxidant"
  | "Antiport" <-> "KW-0050\">Antiport"
  | "Antiviral defense" <-> "KW-0051\">Antiviral defense"
  | "Antiviral protein" <-> "KW-0930\">Antiviral protein"
  | "Apicoplast" <-> "KW-0933\">Apicoplast"
  | "Apoplast" <-> "KW-0052\">Apoplast"
  | "Apoptosis" <-> "KW-0053\">Apoptosis"
  | "Arabinose catabolism" <-> "KW-0054\">Arabinose catabolism"
  | "Arginine biosynthesis" <-> "KW-0055\">Arginine biosynthesis"
  | "Arginine metabolism" <-> "KW-0056\">Arginine metabolism"
  | "Aromatic amino acid biosynthesis" <-> "KW-0057\">Aromatic amino acid biosynthesis"
  | "Aromatic hydrocarbons catabolism" <-> "KW-0058\">Aromatic hydrocarbons catabolism"
  | "Arsenical resistance" <-> "KW-0059\">Arsenical resistance"
  | "Ascorbate biosynthesis" <-> "KW-0060\">Ascorbate biosynthesis"
  | "Asparagine biosynthesis" <-> "KW-0061\">Asparagine biosynthesis"
  | "Aspartic protease inhibitor" <-> "KW-0062\">Aspartic protease inhibitor"
  | "Aspartyl esterase" <-> "KW-0063\">Aspartyl esterase"
  | "Aspartyl protease" <-> "KW-0064\">Aspartyl protease"
  | "Atherosclerosis" <-> "KW-0065\">Atherosclerosis"
  | "ATP-binding" <-> "KW-0067\">ATP-binding"
  | "ATP synthesis" <-> "KW-0066\">ATP synthesis"
  | "Autocatalytic cleavage" <-> "KW-0068\">Autocatalytic cleavage"
  | "Autoimmune encephalomyelitis" <-> "KW-0069\">Autoimmune encephalomyelitis"
  | "Autoimmune uveitis" <-> "KW-0070\">Autoimmune uveitis"
  | "Autoinducer synthesis" <-> "KW-0071\">Autoinducer synthesis"
  | "Autophagy" <-> "KW-0072\">Autophagy"
  | "Auxin biosynthesis" <-> "KW-0073\">Auxin biosynthesis"
  | "Auxin signaling pathway" <-> "KW-0927\">Auxin signaling pathway"
  | "Bacterial capsule" <-> "KW-0875\">Bacterial capsule"
  | "Bacteriochlorophyll biosynthesis" <-> "KW-0077\">Bacteriochlorophyll biosynthesis"
  | "Bacteriochlorophyll" <-> "KW-0076\">Bacteriochlorophyll"
  | "Bacteriocin biosynthesis" <-> "KW-0871\">Bacteriocin biosynthesis"
  | "Bacteriocin immunity" <-> "KW-0079\">Bacteriocin immunity"
  | "Bacteriocin" <-> "KW-0078\">Bacteriocin"
  | "Bacteriocin transport" <-> "KW-0080\">Bacteriocin transport"
  | "Bacteriolytic enzyme" <-> "KW-0081\">Bacteriolytic enzyme"
  | "Bait region" <-> "KW-0082\">Bait region"
  | "Bardet-Biedl syndrome" <-> "KW-0083\">Bardet-Biedl syndrome"
  | "Bartter syndrome" <-> "KW-0910\">Bartter syndrome"
  | "Basement membrane" <-> "KW-0084\">Basement membrane"
  | "B-cell activation" <-> "KW-0075\">B-cell activation"
  | "Behavior" <-> "KW-0085\">Behavior"
  | "Bence-Jones protein" <-> "KW-0086\">Bence-Jones protein"
  | "Bernard Soulier syndrome" <-> "KW-0087\">Bernard Soulier syndrome"
  | "Bile acid catabolism" <-> "KW-0088\">Bile acid catabolism"
  | "Bile pigment" <-> "KW-0089\">Bile pigment"
  | "Biological rhythms" <-> "KW-0090\">Biological rhythms"
  | "Biomineralization" <-> "KW-0091\">Biomineralization"
  | "Biotin biosynthesis" <-> "KW-0093\">Biotin biosynthesis"
  | "Biotin" <-> "KW-0092\">Biotin"
  | "Blood coagulation" <-> "KW-0094\">Blood coagulation"
  | "Blood group antigen" <-> "KW-0095\">Blood group antigen"
  | "Branched-chain amino acid biosynthesis" <-> "KW-0100\">Branched-chain amino acid biosynthesis"
  | "Branched-chain amino acid catabolism" <-> "KW-0101\">Branched-chain amino acid catabolism"
  | "Bromination" <-> "KW-0102\">Bromination"
  | "Bromodomain" <-> "KW-0103\">Bromodomain"
  | "Cadmium" <-> "KW-0104\">Cadmium"
  | "Cadmium resistance" <-> "KW-0105\">Cadmium resistance"
  | "Calcium channel inhibitor" <-> "KW-0108\">Calcium channel inhibitor"
  | "Calcium channel" <-> "KW-0107\">Calcium channel"
  | "Calcium" <-> "KW-0106\">Calcium"
  | "Calcium/phospholipid-binding" <-> "KW-0111\">Calcium/phospholipid-binding"
  | "Calcium transport" <-> "KW-0109\">Calcium transport"
  | "Calmodulin-binding" <-> "KW-0112\">Calmodulin-binding"
  | "Calvin cycle" <-> "KW-0113\">Calvin cycle"
  | "cAMP-binding" <-> "KW-0116\">cAMP-binding"
  | "cAMP biosynthesis" <-> "KW-0115\">cAMP biosynthesis"
  | "cAMP" <-> "KW-0114\">cAMP"
  | "Capsid assembly" <-> "KW-0118\">Capsid assembly"
  | "Capsid maturation" <-> "KW-0917\">Capsid maturation"
  | "Capsid protein" <-> "KW-0167\">Capsid protein"
  | "Carbohydrate metabolism" <-> "KW-0119\">Carbohydrate metabolism"
  | "Carbon dioxide fixation" <-> "KW-0120\">Carbon dioxide fixation"
  | "Carboxypeptidase" <-> "KW-0121\">Carboxypeptidase"
  | "Cardiomyopathy" <-> "KW-0122\">Cardiomyopathy"
  | "Cardiotoxin" <-> "KW-0123\">Cardiotoxin"
  | "Carnitine biosynthesis" <-> "KW-0124\">Carnitine biosynthesis"
  | "Carotenoid biosynthesis" <-> "KW-0125\">Carotenoid biosynthesis"
  | "Cataract" <-> "KW-0898\">Cataract"
  | "Catecholamine biosynthesis" <-> "KW-0127\">Catecholamine biosynthesis"
  | "Catecholamine metabolism" <-> "KW-0128\">Catecholamine metabolism"
  | "CBS domain" <-> "KW-0129\">CBS domain"
  | "Cell adhesion" <-> "KW-0130\">Cell adhesion"
  | "Cell cycle" <-> "KW-0131\">Cell cycle"
  | "Cell division" <-> "KW-0132\">Cell division"
  | "Cell shape" <-> "KW-0133\">Cell shape"
  | "Cellulose biosynthesis" <-> "KW-0135\">Cellulose biosynthesis"
  | "Cellulose degradation" <-> "KW-0136\">Cellulose degradation"
  | "Cell wall" <-> "KW-0134\">Cell wall"
  | "Centromere" <-> "KW-0137\">Centromere"
  | "CF(0)" <-> "KW-0138\">CF(0)"
  | "CF(1)" <-> "KW-0139\">CF(1)"
  | "cGMP-binding" <-> "KW-0142\">cGMP-binding"
  | "cGMP biosynthesis" <-> "KW-0141\">cGMP biosynthesis"
  | "cGMP" <-> "KW-0140\">cGMP"
  | "Chaperone" <-> "KW-0143\">Chaperone"
  | "Charcot-Marie-Tooth disease" <-> "KW-0144\">Charcot-Marie-Tooth disease"
  | "Chemotaxis" <-> "KW-0145\">Chemotaxis"
  | "Chitin-binding" <-> "KW-0147\">Chitin-binding"
  | "Chitin degradation" <-> "KW-0146\">Chitin degradation"
  | "Chloride channel inhibitor" <-> "KW-0870\">Chloride channel inhibitor"
  | "Chloride channel" <-> "KW-0869\">Chloride channel"
  | "Chloride" <-> "KW-0868\">Chloride"
  | "Chlorophyll biosynthesis" <-> "KW-0149\">Chlorophyll biosynthesis"
  | "Chlorophyll catabolism" <-> "KW-0881\">Chlorophyll catabolism"
  | "Chlorophyll" <-> "KW-0148\">Chlorophyll"
  | "Chloroplast" <-> "KW-0150\">Chloroplast"
  | "Chlorosome" <-> "KW-0151\">Chlorosome"
  | "Cholesterol biosynthesis" <-> "KW-0152\">Cholesterol biosynthesis"
  | "Cholesterol metabolism" <-> "KW-0153\">Cholesterol metabolism"
  | "Chondrogenesis" <-> "KW-0891\">Chondrogenesis"
  | "Chromate resistance" <-> "KW-0155\">Chromate resistance"
  | "Chromatin regulator" <-> "KW-0156\">Chromatin regulator"
  | "Chromophore" <-> "KW-0157\">Chromophore"
  | "Chromoplast" <-> "KW-0957\">Chromoplast"
  | "Chromosomal protein" <-> "KW-0158\">Chromosomal protein"
  | "Chromosomal rearrangement" <-> "KW-0160\">Chromosomal rearrangement"
  | "Chromosome partition" <-> "KW-0159\">Chromosome partition"
  | "Chronic granulomatous disease" <-> "KW-0161\">Chronic granulomatous disease"
  | "Chylomicron" <-> "KW-0162\">Chylomicron"
  | "Citrate utilization" <-> "KW-0163\">Citrate utilization"
  | "Citrullination" <-> "KW-0164\">Citrullination"
  | "Cleavage on pair of basic residues" <-> "KW-0165\">Cleavage on pair of basic residues"
  | "Coated pits" <-> "KW-0168\">Coated pits"
  | "Cobalamin biosynthesis" <-> "KW-0169\">Cobalamin biosynthesis"
  | "Cobalamin" <-> "KW-0846\">Cobalamin"
  | "Cobalt" <-> "KW-0170\">Cobalt"
  | "Cobalt transport" <-> "KW-0171\">Cobalt transport"
  | "Cockayne syndrome" <-> "KW-0172\">Cockayne syndrome"
  | "Coenzyme A biosynthesis" <-> "KW-0173\">Coenzyme A biosynthesis"
  | "Coenzyme M biosynthesis" <-> "KW-0174\">Coenzyme M biosynthesis"
  | "Coiled coil" <-> "KW-0175\">Coiled coil"
  | "Collagen degradation" <-> "KW-0177\">Collagen degradation"
  | "Collagen" <-> "KW-0176\">Collagen"
  | "Competence" <-> "KW-0178\">Competence"
  | "Complement alternate pathway" <-> "KW-0179\">Complement alternate pathway"
  | "Complement pathway" <-> "KW-0180\">Complement pathway"
  | "Complete proteome" <-> "KW-0181\">Complete proteome"
  | "Cone-rod dystrophy" <-> "KW-0182\">Cone-rod dystrophy"
  | "Congenital adrenal hyperplasia" <-> "KW-0954\">Congenital adrenal hyperplasia"
  | "Congenital disorder of glycosylation" <-> "KW-0900\">Congenital disorder of glycosylation"
  | "Congenital muscular dystrophy" <-> "KW-0912\">Congenital muscular dystrophy"
  | "Conidiation" <-> "KW-0183\">Conidiation"
  | "Conjugation" <-> "KW-0184\">Conjugation"
  | "Copper" <-> "KW-0186\">Copper"
  | "Copper transport" <-> "KW-0187\">Copper transport"
  | "Copulatory plug" <-> "KW-0188\">Copulatory plug"
  | "Core protein" <-> "KW-0189\">Core protein"
  | "Covalent protein-DNA linkage" <-> "KW-0190\">Covalent protein-DNA linkage"
  | "Covalent protein-RNA linkage" <-> "KW-0191\">Covalent protein-RNA linkage"
  | "Crown gall tumor" <-> "KW-0192\">Crown gall tumor"
  | "CTQ" <-> "KW-0885\">CTQ"
  | "Cuticle" <-> "KW-0193\">Cuticle"
  | "Cyanelle" <-> "KW-0194\">Cyanelle"
  | "Cyclin" <-> "KW-0195\">Cyclin"
  | "Cycloheximide resistance" <-> "KW-0196\">Cycloheximide resistance"
  | "Cyclosporin" <-> "KW-0197\">Cyclosporin"
  | "Cysteine biosynthesis" <-> "KW-0198\">Cysteine biosynthesis"
  | "Cystinuria" <-> "KW-0199\">Cystinuria"
  | "Cytadherence" <-> "KW-0200\">Cytadherence"
  | "Cytochrome c-type biogenesis" <-> "KW-0201\">Cytochrome c-type biogenesis"
  | "Cytokine" <-> "KW-0202\">Cytokine"
  | "Cytokinin biosynthesis" <-> "KW-0203\">Cytokinin biosynthesis"
  | "Cytokinin signaling pathway" <-> "KW-0932\">Cytokinin signaling pathway"
  | "Cytolysis" <-> "KW-0204\">Cytolysis"
  | "Cytosine metabolism" <-> "KW-0205\">Cytosine metabolism"
  | "Cytoskeleton" <-> "KW-0206\">Cytoskeleton"
  | "D-amino acid" <-> "KW-0208\">D-amino acid"
  | "Deafness" <-> "KW-0209\">Deafness"
  | "Decarboxylase" <-> "KW-0210\">Decarboxylase"
  | "Defensin" <-> "KW-0211\">Defensin"
  | "Dejerine-Sottas syndrome" <-> "KW-0213\">Dejerine-Sottas syndrome"
  | "Dental caries" <-> "KW-0214\">Dental caries"
  | "Deoxyribonucleotide synthesis" <-> "KW-0215\">Deoxyribonucleotide synthesis"
  | "Desmin-related myopathy" <-> "KW-0911\">Desmin-related myopathy"
  | "Detoxification" <-> "KW-0216\">Detoxification"
  | "Developmental protein" <-> "KW-0217\">Developmental protein"
  | "Diabetes insipidus" <-> "KW-0218\">Diabetes insipidus"
  | "Diabetes mellitus" <-> "KW-0219\">Diabetes mellitus"
  | "Diaminopimelate biosynthesis" <-> "KW-0220\">Diaminopimelate biosynthesis"
  | "Differentiation" <-> "KW-0221\">Differentiation"
  | "Digestion" <-> "KW-0222\">Digestion"
  | "Dioxygenase" <-> "KW-0223\">Dioxygenase"
  | "Dipeptidase" <-> "KW-0224\">Dipeptidase"
  | "Direct protein sequencing" <-> "KW-0903\">Direct protein sequencing"
  | "Disease mutation" <-> "KW-0225\">Disease mutation"
  | "DNA-binding" <-> "KW-0238\">DNA-binding"
  | "DNA condensation" <-> "KW-0226\">DNA condensation"
  | "DNA damage" <-> "KW-0227\">DNA damage"
  | "DNA-directed DNA polymerase" <-> "KW-0239\">DNA-directed DNA polymerase"
  | "DNA-directed RNA polymerase" <-> "KW-0240\">DNA-directed RNA polymerase"
  | "DNA excision" <-> "KW-0228\">DNA excision"
  | "DNA integration" <-> "KW-0229\">DNA integration"
  | "DNA invertase" <-> "KW-0230\">DNA invertase"
  | "DNA packaging" <-> "KW-0231\">DNA packaging"
  | "DNA recombination" <-> "KW-0233\">DNA recombination"
  | "DNA repair" <-> "KW-0234\">DNA repair"
  | "DNA replication inhibitor" <-> "KW-0236\">DNA replication inhibitor"
  | "DNA replication" <-> "KW-0235\">DNA replication"
  | "DNA synthesis" <-> "KW-0237\">DNA synthesis"
  | "Down syndrome" <-> "KW-0241\">Down syndrome"
  | "Dwarfism" <-> "KW-0242\">Dwarfism"
  | "Dynein" <-> "KW-0243\">Dynein"
  | "Early protein" <-> "KW-0244\">Early protein"
  | "Ectodermal dysplasia" <-> "KW-0038\">Ectodermal dysplasia"
  | "EGF-like domain" <-> "KW-0245\">EGF-like domain"
  | "Ehlers-Danlos syndrome" <-> "KW-0248\">Ehlers-Danlos syndrome"
  | "Electron transport" <-> "KW-0249\">Electron transport"
  | "Elliptocytosis" <-> "KW-0250\">Elliptocytosis"
  | "Elongation factor" <-> "KW-0251\">Elongation factor"
  | "Endocytosis" <-> "KW-0254\">Endocytosis"
  | "Endonuclease" <-> "KW-0255\">Endonuclease"
  | "Endoplasmic reticulum" <-> "KW-0256\">Endoplasmic reticulum"
  | "Endorphin" <-> "KW-0257\">Endorphin"
  | "Enterobactin biosynthesis" <-> "KW-0259\">Enterobactin biosynthesis"
  | "Enterotoxin" <-> "KW-0260\">Enterotoxin"
  | "Envelope protein" <-> "KW-0261\">Envelope protein"
  | "Epidermolysis bullosa" <-> "KW-0263\">Epidermolysis bullosa"
  | "Epilepsy" <-> "KW-0887\">Epilepsy"
  | "ER-Golgi transport" <-> "KW-0931\">ER-Golgi transport"
  | "ERV" <-> "KW-0895\">ERV"
  | "Erythrocyte maturation" <-> "KW-0265\">Erythrocyte maturation"
  | "Ethylene biosynthesis" <-> "KW-0266\">Ethylene biosynthesis"
  | "Ethylene signaling pathway" <-> "KW-0936\">Ethylene signaling pathway"
  | "Excision nuclease" <-> "KW-0267\">Excision nuclease"
  | "Exocytosis" <-> "KW-0268\">Exocytosis"
  | "Exonuclease" <-> "KW-0269\">Exonuclease"
  | "Exopolysaccharide synthesis" <-> "KW-0270\">Exopolysaccharide synthesis"
  | "Exosome" <-> "KW-0271\">Exosome"
  | "Extinct organism protein" <-> "KW-0952\">Extinct organism protein"
  | "Extracellular matrix" <-> "KW-0272\">Extracellular matrix"
  | "Eye lens protein" <-> "KW-0273\">Eye lens protein"
  | "FAD" <-> "KW-0274\">FAD"
  | "Familial hemophagocytic lymphohistiocytosis" <-> "KW-0951\">Familial hemophagocytic lymphohistiocytosis"
  | "Fanconi anemia" <-> "KW-0923\">Fanconi anemia"
  | "Fatty acid biosynthesis" <-> "KW-0275\">Fatty acid biosynthesis"
  | "Fatty acid metabolism" <-> "KW-0276\">Fatty acid metabolism"
  | "Fertilization" <-> "KW-0278\">Fertilization"
  | "Fiber protein" <-> "KW-0279\">Fiber protein"
  | "Fibrinolysis" <-> "KW-0280\">Fibrinolysis"
  | "Fimbria" <-> "KW-0281\">Fimbria"
  | "Flagellar rotation" <-> "KW-0283\">Flagellar rotation"
  | "Flagellum" <-> "KW-0282\">Flagellum"
  | "Flavonoid biosynthesis" <-> "KW-0284\">Flavonoid biosynthesis"
  | "Flavoprotein" <-> "KW-0285\">Flavoprotein"
  | "Flight" <-> "KW-0286\">Flight"
  | "Flowering" <-> "KW-0287\">Flowering"
  | "FMN" <-> "KW-0288\">FMN"
  | "Folate-binding" <-> "KW-0290\">Folate-binding"
  | "Folate biosynthesis" <-> "KW-0289\">Folate biosynthesis"
  | "Formylation" <-> "KW-0291\">Formylation"
  | "Fruiting body" <-> "KW-0293\">Fruiting body"
  | "Fruit ripening" <-> "KW-0292\">Fruit ripening"
  | "Fucose metabolism" <-> "KW-0294\">Fucose metabolism"
  | "Fungicide" <-> "KW-0295\">Fungicide"
  | "Fusion protein" <-> "KW-0296\">Fusion protein"
  | "Galactitol metabolism" <-> "KW-0298\">Galactitol metabolism"
  | "Galactose metabolism" <-> "KW-0299\">Galactose metabolism"
  | "Gamma-carboxyglutamic acid" <-> "KW-0301\">Gamma-carboxyglutamic acid"
  | "Gap junction" <-> "KW-0303\">Gap junction"
  | "Gap protein" <-> "KW-0302\">Gap protein"
  | "Gaseous exchange" <-> "KW-0305\">Gaseous exchange"
  | "Gastrulation" <-> "KW-0306\">Gastrulation"
  | "Gas vesicle" <-> "KW-0304\">Gas vesicle"
  | "Gaucher disease" <-> "KW-0307\">Gaucher disease"
  | "Genetically modified food" <-> "KW-0308\">Genetically modified food"
  | "Germination" <-> "KW-0309\">Germination"
  | "Gibberellin signaling pathway" <-> "KW-0939\">Gibberellin signaling pathway"
  | "Glaucoma" <-> "KW-0955\">Glaucoma"
  | "Gluconate utilization" <-> "KW-0311\">Gluconate utilization"
  | "Gluconeogenesis" <-> "KW-0312\">Gluconeogenesis"
  | "Glucose metabolism" <-> "KW-0313\">Glucose metabolism"
  | "Glutamate biosynthesis" <-> "KW-0314\">Glutamate biosynthesis"
  | "Glutamine amidotransferase" <-> "KW-0315\">Glutamine amidotransferase"
  | "Glutaricaciduria" <-> "KW-0316\">Glutaricaciduria"
  | "Glutathione biosynthesis" <-> "KW-0317\">Glutathione biosynthesis"
  | "Glutathionylation" <-> "KW-0318\">Glutathionylation"
  | "Glycerol metabolism" <-> "KW-0319\">Glycerol metabolism"
  | "Glycogen biosynthesis" <-> "KW-0320\">Glycogen biosynthesis"
  | "Glycogen metabolism" <-> "KW-0321\">Glycogen metabolism"
  | "Glycogen storage disease" <-> "KW-0322\">Glycogen storage disease"
  | "Glycolate pathway" <-> "KW-0323\">Glycolate pathway"
  | "Glycolysis" <-> "KW-0324\">Glycolysis"
  | "Glycoprotein" <-> "KW-0325\">Glycoprotein"
  | "Glycosidase" <-> "KW-0326\">Glycosidase"
  | "Glycosome" <-> "KW-0327\">Glycosome"
  | "Glycosyltransferase" <-> "KW-0328\">Glycosyltransferase"
  | "Glyoxylate bypass" <-> "KW-0329\">Glyoxylate bypass"
  | "Glyoxysome" <-> "KW-0330\">Glyoxysome"
  | "GM2-gangliosidosis" <-> "KW-0331\">GM2-gangliosidosis"
  | "GMP biosynthesis" <-> "KW-0332\">GMP biosynthesis"
  | "Golgi apparatus" <-> "KW-0333\">Golgi apparatus"
  | "Gonadal differentiation" <-> "KW-0334\">Gonadal differentiation"
  | "Gout" <-> "KW-0335\">Gout"
  | "GPI-anchor biosynthesis" <-> "KW-0337\">GPI-anchor biosynthesis"
  | "GPI-anchor" <-> "KW-0336\">GPI-anchor"
  | "G-protein coupled receptor" <-> "KW-0297\">G-protein coupled receptor"
  | "Growth arrest" <-> "KW-0338\">Growth arrest"
  | "Growth factor binding" <-> "KW-0340\">Growth factor binding"
  | "Growth factor" <-> "KW-0339\">Growth factor"
  | "Growth regulation" <-> "KW-0341\">Growth regulation"
  | "GTPase activation" <-> "KW-0343\">GTPase activation"
  | "GTP-binding" <-> "KW-0342\">GTP-binding"
  | "Guanine-nucleotide releasing factor" <-> "KW-0344\">Guanine-nucleotide releasing factor"
  | "HDL" <-> "KW-0345\">HDL"
  | "Helicase" <-> "KW-0347\">Helicase"
  | "Hemagglutinin" <-> "KW-0348\">Hemagglutinin"
  | "Heme biosynthesis" <-> "KW-0350\">Heme biosynthesis"
  | "Heme" <-> "KW-0349\">Heme"
  | "Hemoglobin-binding" <-> "KW-0351\">Hemoglobin-binding"
  | "Hemolymph clotting" <-> "KW-0353\">Hemolymph clotting"
  | "Hemolysis" <-> "KW-0354\">Hemolysis"
  | "Hemophilia" <-> "KW-0355\">Hemophilia"
  | "Hemostasis" <-> "KW-0356\">Hemostasis"
  | "Heparan sulfate" <-> "KW-0357\">Heparan sulfate"
  | "Heparin-binding" <-> "KW-0358\">Heparin-binding"
  | "Herbicide resistance" <-> "KW-0359\">Herbicide resistance"
  | "Hereditary hemolytic anemia" <-> "KW-0360\">Hereditary hemolytic anemia"
  | "Hereditary multiple exostoses" <-> "KW-0361\">Hereditary multiple exostoses"
  | "Hereditary nonpolyposis colorectal cancer" <-> "KW-0362\">Hereditary nonpolyposis colorectal cancer"
  | "Hereditary spastic paraplegia" <-> "KW-0890\">Hereditary spastic paraplegia"
  | "Hermansky-Pudlak syndrome" <-> "KW-0363\">Hermansky-Pudlak syndrome"
  | "Heterocyst" <-> "KW-0364\">Heterocyst"
  | "Hexon-associated protein" <-> "KW-0366\">Hexon-associated protein"
  | "Hexon protein" <-> "KW-0365\">Hexon protein"
  | "Hibernation" <-> "KW-0909\">Hibernation"
  | "Hirschsprung disease" <-> "KW-0367\">Hirschsprung disease"
  | "Histidine biosynthesis" <-> "KW-0368\">Histidine biosynthesis"
  | "Histidine metabolism" <-> "KW-0369\">Histidine metabolism"
  | "Holoprosencephaly" <-> "KW-0370\">Holoprosencephaly"
  | "Homeobox" <-> "KW-0371\">Homeobox"
  | "Hormone" <-> "KW-0372\">Hormone"
  | "Host-virus interaction" <-> "KW-0945\">Host-virus interaction"
  | "Hyaluronic acid" <-> "KW-0373\">Hyaluronic acid"
  | "Hybridoma" <-> "KW-0374\">Hybridoma"
  | "Hydrogen ion transport" <-> "KW-0375\">Hydrogen ion transport"
  | "Hydrogenosome" <-> "KW-0377\">Hydrogenosome"
  | "Hydrogen peroxide" <-> "KW-0376\">Hydrogen peroxide"
  | "Hydrolase" <-> "KW-0378\">Hydrolase"
  | "Hydroxylation" <-> "KW-0379\">Hydroxylation"
  | "Hyperlipidemia" <-> "KW-0380\">Hyperlipidemia"
  | "Hypersensitive response elicitation" <-> "KW-0928\">Hypersensitive response elicitation"
  | "Hypersensitive response" <-> "KW-0381\">Hypersensitive response"
  | "Hypotensive agent" <-> "KW-0382\">Hypotensive agent"
  | "Hypothetical protein" <-> "KW-0384\">Hypothetical protein"
  | "Hypusine biosynthesis" <-> "KW-0386\">Hypusine biosynthesis"
  | "Hypusine" <-> "KW-0385\">Hypusine"
  | "Ice nucleation" <-> "KW-0387\">Ice nucleation"
  | "IgA-binding protein" <-> "KW-0388\">IgA-binding protein"
  | "IgE-binding protein" <-> "KW-0389\">IgE-binding protein"
  | "IgG-binding protein" <-> "KW-0390\">IgG-binding protein"
  | "Immune response" <-> "KW-0391\">Immune response"
  | "Immunoglobulin C region" <-> "KW-0392\">Immunoglobulin C region"
  | "Immunoglobulin domain" <-> "KW-0393\">Immunoglobulin domain"
  | "Immunoglobulin V region" <-> "KW-0394\">Immunoglobulin V region"
  | "Inflammatory response" <-> "KW-0395\">Inflammatory response"
  | "Initiation factor" <-> "KW-0396\">Initiation factor"
  | "Innate immunity" <-> "KW-0399\">Innate immunity"
  | "Inner membrane" <-> "KW-0397\">Inner membrane"
  | "Inositol biosynthesis" <-> "KW-0398\">Inositol biosynthesis"
  | "Integrin" <-> "KW-0401\">Integrin"
  | "Interferon antiviral system evasion" <-> "KW-0922\">Interferon antiviral system evasion"
  | "Interferon induction" <-> "KW-0402\">Interferon induction"
  | "Intermediate filament" <-> "KW-0403\">Intermediate filament"
  | "Intron homing" <-> "KW-0404\">Intron homing"
  | "Iodination" <-> "KW-0405\">Iodination"
  | "Ionic channel inhibitor" <-> "KW-0872\">Ionic channel inhibitor"
  | "Ionic channel" <-> "KW-0407\">Ionic channel"
  | "Ion transport" <-> "KW-0406\">Ion transport"
  | "Iron" <-> "KW-0408\">Iron"
  | "Iron storage" <-> "KW-0409\">Iron storage"
  | "Iron-sulfur" <-> "KW-0411\">Iron-sulfur"
  | "Iron transport" <-> "KW-0410\">Iron transport"
  | "Isoleucine biosynthesis" <-> "KW-0412\">Isoleucine biosynthesis"
  | "Isomerase" <-> "KW-0413\">Isomerase"
  | "Isoprene biosynthesis" <-> "KW-0414\">Isoprene biosynthesis"
  | "Kallmann syndrome" <-> "KW-0956\">Kallmann syndrome"
  | "Karyogamy" <-> "KW-0415\">Karyogamy"
  | "Kelch repeat" <-> "KW-0880\">Kelch repeat"
  | "Keratinization" <-> "KW-0417\">Keratinization"
  | "Keratin" <-> "KW-0416\">Keratin"
  | "Kinase" <-> "KW-0418\">Kinase"
  | "Kinetoplast" <-> "KW-0419\">Kinetoplast"
  | "Kringle" <-> "KW-0420\">Kringle"
  | "Lacrimo-auriculo-dento-digital syndrome" <-> "KW-0953\">Lacrimo-auriculo-dento-digital syndrome"
  | "Lactation" <-> "KW-0421\">Lactation"
  | "Lactose biosynthesis" <-> "KW-0422\">Lactose biosynthesis"
  | "Lactose metabolism" <-> "KW-0423\">Lactose metabolism"
  | "Laminin EGF-like domain" <-> "KW-0424\">Laminin EGF-like domain"
  | "Lantibiotic" <-> "KW-0425\">Lantibiotic"
  | "Late protein" <-> "KW-0426\">Late protein"
  | "LDL" <-> "KW-0427\">LDL"
  | "Leader peptide" <-> "KW-0428\">Leader peptide"
  | "Leber congenital amaurosis" <-> "KW-0901\">Leber congenital amaurosis"
  | "Leber hereditary optic neuropathy" <-> "KW-0429\">Leber hereditary optic neuropathy"
  | "Lectin" <-> "KW-0430\">Lectin"
  | "Leigh syndrome" <-> "KW-0431\">Leigh syndrome"
  | "Leucine biosynthesis" <-> "KW-0432\">Leucine biosynthesis"
  | "Leucine-rich repeat" <-> "KW-0433\">Leucine-rich repeat"
  | "Leukotriene biosynthesis" <-> "KW-0434\">Leukotriene biosynthesis"
  | "Li-Fraumeni syndrome" <-> "KW-0435\">Li-Fraumeni syndrome"
  | "Ligase" <-> "KW-0436\">Ligase"
  | "Light-harvesting polypeptide" <-> "KW-0437\">Light-harvesting polypeptide"
  | "Lignin biosynthesis" <-> "KW-0438\">Lignin biosynthesis"
  | "Lignin degradation" <-> "KW-0439\">Lignin degradation"
  | "Limb-girdle muscular dystrophy" <-> "KW-0947\">Limb-girdle muscular dystrophy"
  | "LIM domain" <-> "KW-0440\">LIM domain"
  | "Lipid A biosynthesis" <-> "KW-0441\">Lipid A biosynthesis"
  | "Lipid-binding" <-> "KW-0446\">Lipid-binding"
  | "Lipid degradation" <-> "KW-0442\">Lipid degradation"
  | "Lipid metabolism" <-> "KW-0443\">Lipid metabolism"
  | "Lipid synthesis" <-> "KW-0444\">Lipid synthesis"
  | "Lipid transport" <-> "KW-0445\">Lipid transport"
  | "Lipopolysaccharide biosynthesis" <-> "KW-0448\">Lipopolysaccharide biosynthesis"
  | "Lipoprotein" <-> "KW-0449\">Lipoprotein"
  | "Lipoyl" <-> "KW-0450\">Lipoyl"
  | "Lissencephaly" <-> "KW-0451\">Lissencephaly"
  | "Lithium" <-> "KW-0452\">Lithium"
  | "Long QT syndrome" <-> "KW-0454\">Long QT syndrome"
  | "LTQ" <-> "KW-0886\">LTQ"
  | "Luminescence" <-> "KW-0455\">Luminescence"
  | "Lyase" <-> "KW-0456\">Lyase"
  | "Lysine biosynthesis" <-> "KW-0457\">Lysine biosynthesis"
  | "Lysosome" <-> "KW-0458\">Lysosome"
  | "Magnesium" <-> "KW-0460\">Magnesium"
  | "Malaria" <-> "KW-0461\">Malaria"
  | "Maltose metabolism" <-> "KW-0462\">Maltose metabolism"
  | "Mandelate pathway" <-> "KW-0463\">Mandelate pathway"
  | "Manganese" <-> "KW-0464\">Manganese"
  | "Mannose-binding" <-> "KW-0465\">Mannose-binding"
  | "Maple syrup urine disease" <-> "KW-0466\">Maple syrup urine disease"
  | "Mast cell degranulation" <-> "KW-0467\">Mast cell degranulation"
  | "Meiosis" <-> "KW-0469\">Meiosis"
  | "Melanin biosynthesis" <-> "KW-0470\">Melanin biosynthesis"
  | "MELAS syndrome" <-> "KW-0867\">MELAS syndrome"
  | "Melatonin biosynthesis" <-> "KW-0471\">Melatonin biosynthesis"
  | "Membrane attack complex" <-> "KW-0473\">Membrane attack complex"
  | "Membrane" <-> "KW-0472\">Membrane"
  | "Menaquinone biosynthesis" <-> "KW-0474\">Menaquinone biosynthesis"
  | "Mercuric resistance" <-> "KW-0475\">Mercuric resistance"
  | "Mercury" <-> "KW-0476\">Mercury"
  | "Merozoite" <-> "KW-0477\">Merozoite"
  | "Metachromatic leukodystrophy" <-> "KW-0478\">Metachromatic leukodystrophy"
  | "Metal-binding" <-> "KW-0479\">Metal-binding"
  | "Metalloenzyme inhibitor" <-> "KW-0481\">Metalloenzyme inhibitor"
  | "Metalloprotease inhibitor" <-> "KW-0483\">Metalloprotease inhibitor"
  | "Metalloprotease" <-> "KW-0482\">Metalloprotease"
  | "Metal-thiolate cluster" <-> "KW-0480\">Metal-thiolate cluster"
  | "Methanogenesis" <-> "KW-0484\">Methanogenesis"
  | "Methanol utilization" <-> "KW-0485\">Methanol utilization"
  | "Methionine biosynthesis" <-> "KW-0486\">Methionine biosynthesis"
  | "Methotrexate resistance" <-> "KW-0487\">Methotrexate resistance"
  | "Methylation" <-> "KW-0488\">Methylation"
  | "Methyltransferase" <-> "KW-0489\">Methyltransferase"
  | "MHC II" <-> "KW-0491\">MHC II"
  | "MHC I" <-> "KW-0490\">MHC I"
  | "Microsome" <-> "KW-0492\">Microsome"
  | "Microtubule" <-> "KW-0493\">Microtubule"
  | "Milk protein" <-> "KW-0494\">Milk protein"
  | "Mineral balance" <-> "KW-0495\">Mineral balance"
  | "Mitochondrion" <-> "KW-0496\">Mitochondrion"
  | "Mitogen" <-> "KW-0497\">Mitogen"
  | "Mitosis" <-> "KW-0498\">Mitosis"
  | "Mobility protein" <-> "KW-0499\">Mobility protein"
  | "Molybdenum cofactor biosynthesis" <-> "KW-0501\">Molybdenum cofactor biosynthesis"
  | "Molybdenum" <-> "KW-0500\">Molybdenum"
  | "Monoclonal antibody" <-> "KW-0502\">Monoclonal antibody"
  | "Monooxygenase" <-> "KW-0503\">Monooxygenase"
  | "Morphogen" <-> "KW-0504\">Morphogen"
  | "Motor protein" <-> "KW-0505\">Motor protein"
  | "mRNA capping" <-> "KW-0506\">mRNA capping"
  | "mRNA processing" <-> "KW-0507\">mRNA processing"
  | "mRNA splicing" <-> "KW-0508\">mRNA splicing"
  | "mRNA transport" <-> "KW-0509\">mRNA transport"
  | "Mucolipidosis" <-> "KW-0942\">Mucolipidosis"
  | "Mucopolysaccharidosis" <-> "KW-0510\">Mucopolysaccharidosis"
  | "Multifunctional enzyme" <-> "KW-0511\">Multifunctional enzyme"
  | "Muscle protein" <-> "KW-0514\">Muscle protein"
  | "Mutator protein" <-> "KW-0515\">Mutator protein"
  | "Myogenesis" <-> "KW-0517\">Myogenesis"
  | "Myosin" <-> "KW-0518\">Myosin"
  | "Myotoxin" <-> "KW-0959\">Myotoxin"
  | "Myristate" <-> "KW-0519\">Myristate"
  | "NAD" <-> "KW-0520\">NAD"
  | "NADP" <-> "KW-0521\">NADP"
  | "Nematocyst" <-> "KW-0166\">Nematocyst"
  | "Neurodegeneration" <-> "KW-0523\">Neurodegeneration"
  | "Neurogenesis" <-> "KW-0524\">Neurogenesis"
  | "Neuronal ceroid lipofuscinosis" <-> "KW-0525\">Neuronal ceroid lipofuscinosis"
  | "Neuropeptide" <-> "KW-0527\">Neuropeptide"
  | "Neurotoxin" <-> "KW-0528\">Neurotoxin"
  | "Neurotransmitter biosynthesis" <-> "KW-0530\">Neurotransmitter biosynthesis"
  | "Neurotransmitter degradation" <-> "KW-0531\">Neurotransmitter degradation"
  | "Neurotransmitter" <-> "KW-0529\">Neurotransmitter"
  | "Neurotransmitter transport" <-> "KW-0532\">Neurotransmitter transport"
  | "Nickel" <-> "KW-0533\">Nickel"
  | "Nickel transport" <-> "KW-0921\">Nickel transport"
  | "Nitrate assimilation" <-> "KW-0534\">Nitrate assimilation"
  | "Nitration" <-> "KW-0944\">Nitration"
  | "Nitrogen fixation" <-> "KW-0535\">Nitrogen fixation"
  | "Nodulation" <-> "KW-0536\">Nodulation"
  | "Nonsense-mediated mRNA decay" <-> "KW-0866\">Nonsense-mediated mRNA decay"
  | "Notch signaling pathway" <-> "KW-0914\">Notch signaling pathway"
  | "Nuclear pore complex" <-> "KW-0906\">Nuclear pore complex"
  | "Nuclear protein" <-> "KW-0539\">Nuclear protein"
  | "Nuclease" <-> "KW-0540\">Nuclease"
  | "Nucleomorph" <-> "KW-0542\">Nucleomorph"
  | "Nucleosome core" <-> "KW-0544\">Nucleosome core"
  | "Nucleotide-binding" <-> "KW-0547\">Nucleotide-binding"
  | "Nucleotide biosynthesis" <-> "KW-0545\">Nucleotide biosynthesis"
  | "Nucleotide metabolism" <-> "KW-0546\">Nucleotide metabolism"
  | "Nucleotidyltransferase" <-> "KW-0548\">Nucleotidyltransferase"
  | "Nylon degradation" <-> "KW-0549\">Nylon degradation"
  | "Obesity" <-> "KW-0550\">Obesity"
  | "Oil body" <-> "KW-0551\">Oil body"
  | "Olfaction" <-> "KW-0552\">Olfaction"
  | "Oncogene" <-> "KW-0553\">Oncogene"
  | "One-carbon metabolism" <-> "KW-0554\">One-carbon metabolism"
  | "Oogenesis" <-> "KW-0896\">Oogenesis"
  | "Opioid peptide" <-> "KW-0555\">Opioid peptide"
  | "Organic radical" <-> "KW-0556\">Organic radical"
  | "Osteogenesis" <-> "KW-0892\">Osteogenesis"
  | "Outer membrane" <-> "KW-0557\">Outer membrane"
  | "Oxidation" <-> "KW-0558\">Oxidation"
  | "Oxidoreductase" <-> "KW-0560\">Oxidoreductase"
  | "Oxygen transport" <-> "KW-0561\">Oxygen transport"
  | "Oxylipin biosynthesis" <-> "KW-0925\">Oxylipin biosynthesis"
  | "Paired box" <-> "KW-0563\">Paired box"
  | "Pair-rule protein" <-> "KW-0562\">Pair-rule protein"
  | "Palmitate" <-> "KW-0564\">Palmitate"
  | "Pantothenate biosynthesis" <-> "KW-0566\">Pantothenate biosynthesis"
  | "Parkinson disease" <-> "KW-0907\">Parkinson disease"
  | "Parkinsonism" <-> "KW-0908\">Parkinsonism"
  | "Pathogenesis-related protein" <-> "KW-0568\">Pathogenesis-related protein"
  | "Pentose shunt" <-> "KW-0570\">Pentose shunt"
  | "Peptide transport" <-> "KW-0571\">Peptide transport"
  | "Peptidoglycan-anchor" <-> "KW-0572\">Peptidoglycan-anchor"
  | "Peptidoglycan synthesis" <-> "KW-0573\">Peptidoglycan synthesis"
  | "Periplasmic" <-> "KW-0574\">Periplasmic"
  | "Peroxidase" <-> "KW-0575\">Peroxidase"
  | "Peroxisome biogenesis disorder" <-> "KW-0958\">Peroxisome biogenesis disorder"
  | "Peroxisome" <-> "KW-0576\">Peroxisome"
  | "PHA biosynthesis" <-> "KW-0577\">PHA biosynthesis"
  | "Phage lysis protein" <-> "KW-0578\">Phage lysis protein"
  | "Phage maturation" <-> "KW-0579\">Phage maturation"
  | "Phage recognition" <-> "KW-0580\">Phage recognition"
  | "Phagocytosis" <-> "KW-0581\">Phagocytosis"
  | "Pharmaceutical" <-> "KW-0582\">Pharmaceutical"
  | "PHB biosynthesis" <-> "KW-0583\">PHB biosynthesis"
  | "Phenylalanine biosynthesis" <-> "KW-0584\">Phenylalanine biosynthesis"
  | "Phenylalanine catabolism" <-> "KW-0585\">Phenylalanine catabolism"
  | "Phenylketonuria" <-> "KW-0586\">Phenylketonuria"
  | "Phenylpropanoid metabolism" <-> "KW-0587\">Phenylpropanoid metabolism"
  | "Pheromone-binding" <-> "KW-0590\">Pheromone-binding"
  | "Pheromone" <-> "KW-0588\">Pheromone"
  | "Pheromone response" <-> "KW-0589\">Pheromone response"
  | "Phorbol-ester binding" <-> "KW-0591\">Phorbol-ester binding"
  | "Phosphate transport" <-> "KW-0592\">Phosphate transport"
  | "Phospholipase A2 inhibitor" <-> "KW-0593\">Phospholipase A2 inhibitor"
  | "Phospholipid biosynthesis" <-> "KW-0594\">Phospholipid biosynthesis"
  | "Phospholipid degradation" <-> "KW-0595\">Phospholipid degradation"
  | "Phosphonate transport" <-> "KW-0918\">Phosphonate transport"
  | "Phosphopantetheine" <-> "KW-0596\">Phosphopantetheine"
  | "Phosphorylation" <-> "KW-0597\">Phosphorylation"
  | "Phosphotransferase system" <-> "KW-0598\">Phosphotransferase system"
  | "Photoprotein" <-> "KW-0599\">Photoprotein"
  | "Photoreceptor protein" <-> "KW-0600\">Photoreceptor protein"
  | "Photorespiration" <-> "KW-0601\">Photorespiration"
  | "Photosynthesis" <-> "KW-0602\">Photosynthesis"
  | "Photosystem II" <-> "KW-0604\">Photosystem II"
  | "Photosystem I" <-> "KW-0603\">Photosystem I"
  | "Phycobilisome" <-> "KW-0605\">Phycobilisome"
  | "Phytochrome signaling pathway" <-> "KW-0607\">Phytochrome signaling pathway"
  | "Pigment" <-> "KW-0608\">Pigment"
  | "Plant defense" <-> "KW-0611\">Plant defense"
  | "Plant toxin" <-> "KW-0612\">Plant toxin"
  | "Plasmid copy control" <-> "KW-0615\">Plasmid copy control"
  | "Plasmid" <-> "KW-0614\">Plasmid"
  | "Plasmid partition" <-> "KW-0616\">Plasmid partition"
  | "Plasminogen activation" <-> "KW-0617\">Plasminogen activation"
  | "Plastid" <-> "KW-0934\">Plastid"
  | "Plastoquinone" <-> "KW-0618\">Plastoquinone"
  | "Polyamine biosynthesis" <-> "KW-0620\">Polyamine biosynthesis"
  | "Polymorphism" <-> "KW-0621\">Polymorphism"
  | "Polyneuropathy" <-> "KW-0622\">Polyneuropathy"
  | "Polysaccharide degradation" <-> "KW-0624\">Polysaccharide degradation"
  | "Polysaccharide transport" <-> "KW-0625\">Polysaccharide transport"
  | "Porin" <-> "KW-0626\">Porin"
  | "Porphyrin biosynthesis" <-> "KW-0627\">Porphyrin biosynthesis"
  | "Postsynaptic membrane" <-> "KW-0628\">Postsynaptic membrane"
  | "Postsynaptic neurotoxin" <-> "KW-0629\">Postsynaptic neurotoxin"
  | "Potassium channel inhibitor" <-> "KW-0632\">Potassium channel inhibitor"
  | "Potassium channel" <-> "KW-0631\">Potassium channel"
  | "Potassium" <-> "KW-0630\">Potassium"
  | "Potassium transport" <-> "KW-0633\">Potassium transport"
  | "PQQ biosynthesis" <-> "KW-0884\">PQQ biosynthesis"
  | "PQQ" <-> "KW-0634\">PQQ"
  | "Pregnancy" <-> "KW-0635\">Pregnancy"
  | "Prenylation" <-> "KW-0636\">Prenylation"
  | "Prenyltransferase" <-> "KW-0637\">Prenyltransferase"
  | "Presynaptic neurotoxin" <-> "KW-0638\">Presynaptic neurotoxin"
  | "Primary microcephaly" <-> "KW-0905\">Primary microcephaly"
  | "Primosome" <-> "KW-0639\">Primosome"
  | "Prion" <-> "KW-0640\">Prion"
  | "Progressive external ophthalmoplegia" <-> "KW-0935\">Progressive external ophthalmoplegia"
  | "Proline biosynthesis" <-> "KW-0641\">Proline biosynthesis"
  | "Proline metabolism" <-> "KW-0642\">Proline metabolism"
  | "Prostaglandin biosynthesis" <-> "KW-0643\">Prostaglandin biosynthesis"
  | "Prostaglandin metabolism" <-> "KW-0644\">Prostaglandin metabolism"
  | "Protease inhibitor" <-> "KW-0646\">Protease inhibitor"
  | "Protease" <-> "KW-0645\">Protease"
  | "Proteasome" <-> "KW-0647\">Proteasome"
  | "Protein biosynthesis" <-> "KW-0648\">Protein biosynthesis"
  | "Protein kinase inhibitor" <-> "KW-0649\">Protein kinase inhibitor"
  | "Protein phosphatase inhibitor" <-> "KW-0650\">Protein phosphatase inhibitor"
  | "Protein phosphatase" <-> "KW-0904\">Protein phosphatase"
  | "Protein splicing" <-> "KW-0651\">Protein splicing"
  | "Protein synthesis inhibitor" <-> "KW-0652\">Protein synthesis inhibitor"
  | "Protein transport" <-> "KW-0653\">Protein transport"
  | "Proteoglycan" <-> "KW-0654\">Proteoglycan"
  | "Prothrombin activator" <-> "KW-0655\">Prothrombin activator"
  | "Proto-oncogene" <-> "KW-0656\">Proto-oncogene"
  | "Pseudohermaphroditism" <-> "KW-0657\">Pseudohermaphroditism"
  | "Purine biosynthesis" <-> "KW-0658\">Purine biosynthesis"
  | "Purine metabolism" <-> "KW-0659\">Purine metabolism"
  | "Purine salvage" <-> "KW-0660\">Purine salvage"
  | "Putrescine biosynthesis" <-> "KW-0661\">Putrescine biosynthesis"
  | "Pyridine nucleotide biosynthesis" <-> "KW-0662\">Pyridine nucleotide biosynthesis"
  | "Pyridoxal phosphate" <-> "KW-0663\">Pyridoxal phosphate"
  | "Pyridoxine biosynthesis" <-> "KW-0664\">Pyridoxine biosynthesis"
  | "Pyrimidine biosynthesis" <-> "KW-0665\">Pyrimidine biosynthesis"
  | "Pyrogen" <-> "KW-0666\">Pyrogen"
  | "Pyropoikilocytosis" <-> "KW-0668\">Pyropoikilocytosis"
  | "Pyrrolidone carboxylic acid" <-> "KW-0873\">Pyrrolidone carboxylic acid"
  | "Pyrrolysine" <-> "KW-0669\">Pyrrolysine"
  | "Pyruvate" <-> "KW-0670\">Pyruvate"
  | "Queuosine biosynthesis" <-> "KW-0671\">Queuosine biosynthesis"
  | "Quinate metabolism" <-> "KW-0672\">Quinate metabolism"
  | "Quinone" <-> "KW-0874\">Quinone"
  | "Quorum sensing" <-> "KW-0673\">Quorum sensing"
  | "Reaction center" <-> "KW-0674\">Reaction center"
  | "Receptor" <-> "KW-0675\">Receptor"
  | "Redox-active center" <-> "KW-0676\">Redox-active center"
  | "Repeat" <-> "KW-0677\">Repeat"
  | "Repressor" <-> "KW-0678\">Repressor"
  | "Respiratory chain" <-> "KW-0679\">Respiratory chain"
  | "Restriction system" <-> "KW-0680\">Restriction system"
  | "Retinal protein" <-> "KW-0681\">Retinal protein"
  | "Retinitis pigmentosa" <-> "KW-0682\">Retinitis pigmentosa"
  | "Retinol-binding" <-> "KW-0683\">Retinol-binding"
  | "Rhamnose metabolism" <-> "KW-0684\">Rhamnose metabolism"
  | "Rhizomelic chondrodysplasia punctata" <-> "KW-0685\">Rhizomelic chondrodysplasia punctata"
  | "Riboflavin biosynthesis" <-> "KW-0686\">Riboflavin biosynthesis"
  | "Ribonucleoprotein" <-> "KW-0687\">Ribonucleoprotein"
  | "Ribosomal frameshift" <-> "KW-0688\">Ribosomal frameshift"
  | "Ribosomal protein" <-> "KW-0689\">Ribosomal protein"
  | "Ribosome biogenesis" <-> "KW-0690\">Ribosome biogenesis"
  | "RNA-binding" <-> "KW-0694\">RNA-binding"
  | "RNA-directed DNA polymerase" <-> "KW-0695\">RNA-directed DNA polymerase"
  | "RNA-directed RNA polymerase" <-> "KW-0696\">RNA-directed RNA polymerase"
  | "RNA editing" <-> "KW-0691\">RNA editing"
  | "RNA-mediated gene silencing" <-> "KW-0943\">RNA-mediated gene silencing"
  | "RNA repair" <-> "KW-0692\">RNA repair"
  | "RNA replication" <-> "KW-0693\">RNA replication"
  | "Rotamase" <-> "KW-0697\">Rotamase"
  | "rRNA-binding" <-> "KW-0699\">rRNA-binding"
  | "rRNA processing" <-> "KW-0698\">rRNA processing"
  | "S-adenosyl-L-methionine" <-> "KW-0949\">S-adenosyl-L-methionine"
  | "Sarcoplasmic reticulum" <-> "KW-0703\">Sarcoplasmic reticulum"
  | "Schiff base" <-> "KW-0704\">Schiff base"
  | "SCID" <-> "KW-0705\">SCID"
  | "Seed storage protein" <-> "KW-0708\">Seed storage protein"
  | "Segmentation polarity protein" <-> "KW-0709\">Segmentation polarity protein"
  | "Selenium" <-> "KW-0711\">Selenium"
  | "Selenocysteine" <-> "KW-0712\">Selenocysteine"
  | "Self-incompatibility" <-> "KW-0713\">Self-incompatibility"
  | "Sensory transduction" <-> "KW-0716\">Sensory transduction"
  | "Septation" <-> "KW-0717\">Septation"
  | "Serine biosynthesis" <-> "KW-0718\">Serine biosynthesis"
  | "Serine esterase" <-> "KW-0719\">Serine esterase"
  | "Serine protease homolog" <-> "KW-0721\">Serine protease homolog"
  | "Serine protease inhibitor" <-> "KW-0722\">Serine protease inhibitor"
  | "Serine protease" <-> "KW-0720\">Serine protease"
  | "Serine/threonine-protein kinase" <-> "KW-0723\">Serine/threonine-protein kinase"
  | "Serotonin biosynthesis" <-> "KW-0724\">Serotonin biosynthesis"
  | "Sexual differentiation" <-> "KW-0726\">Sexual differentiation"
  | "SH2 domain" <-> "KW-0727\">SH2 domain"
  | "SH3-binding" <-> "KW-0729\">SH3-binding"
  | "SH3 domain" <-> "KW-0728\">SH3 domain"
  | "Short QT syndrome" <-> "KW-0940\">Short QT syndrome"
  | "Sialic acid" <-> "KW-0730\">Sialic acid"
  | "Sigma factor" <-> "KW-0731\">Sigma factor"
  | "Signal-anchor" <-> "KW-0735\">Signal-anchor"
  | "Signal" <-> "KW-0732\">Signal"
  | "Signalosome" <-> "KW-0736\">Signalosome"
  | "Signal recognition particle" <-> "KW-0733\">Signal recognition particle"
  | "Signal transduction inhibitor" <-> "KW-0734\">Signal transduction inhibitor"
  | "Silk protein" <-> "KW-0737\">Silk protein"
  | "S-layer" <-> "KW-0701\">S-layer"
  | "S-nitrosylation" <-> "KW-0702\">S-nitrosylation"
  | "Sodium channel inhibitor" <-> "KW-0738\">Sodium channel inhibitor"
  | "Sodium channel" <-> "KW-0894\">Sodium channel"
  | "Sodium" <-> "KW-0915\">Sodium"
  | "Sodium/potassium transport" <-> "KW-0740\">Sodium/potassium transport"
  | "Sodium transport" <-> "KW-0739\">Sodium transport"
  | "SOS mutagenesis" <-> "KW-0741\">SOS mutagenesis"
  | "SOS response" <-> "KW-0742\">SOS response"
  | "Spermatogenesis" <-> "KW-0744\">Spermatogenesis"
  | "Spermidine biosynthesis" <-> "KW-0745\">Spermidine biosynthesis"
  | "Sphingolipid metabolism" <-> "KW-0746\">Sphingolipid metabolism"
  | "Spinocerebellar ataxia" <-> "KW-0950\">Spinocerebellar ataxia"
  | "Spliceosome" <-> "KW-0747\">Spliceosome"
  | "Sporozoite" <-> "KW-0748\">Sporozoite"
  | "Sporulation" <-> "KW-0749\">Sporulation"
  | "Starch biosynthesis" <-> "KW-0750\">Starch biosynthesis"
  | "Stargardt disease" <-> "KW-0751\">Stargardt disease"
  | "Steroid-binding" <-> "KW-0754\">Steroid-binding"
  | "Steroid biosynthesis" <-> "KW-0752\">Steroid biosynthesis"
  | "Steroid metabolism" <-> "KW-0753\">Steroid metabolism"
  | "Steroidogenesis" <-> "KW-0755\">Steroidogenesis"
  | "Sterol biosynthesis" <-> "KW-0756\">Sterol biosynthesis"
  | "Stickler syndrome" <-> "KW-0757\">Stickler syndrome"
  | "Storage protein" <-> "KW-0758\">Storage protein"
  | "Streptomycin biosynthesis" <-> "KW-0759\">Streptomycin biosynthesis"
  | "Stress response" <-> "KW-0346\">Stress response"
  | "Structural protein" <-> "KW-0760\">Structural protein"
  | "Sugar transport" <-> "KW-0762\">Sugar transport"
  | "Sulfate respiration" <-> "KW-0763\">Sulfate respiration"
  | "Sulfate transport" <-> "KW-0764\">Sulfate transport"
  | "Sulfation" <-> "KW-0765\">Sulfation"
  | "Superantigen" <-> "KW-0766\">Superantigen"
  | "Suppressor of RNA silencing" <-> "KW-0941\">Suppressor of RNA silencing"
  | "Surface film" <-> "KW-0767\">Surface film"
  | "Sushi" <-> "KW-0768\">Sushi"
  | "Symport" <-> "KW-0769\">Symport"
  | "Synapse" <-> "KW-0770\">Synapse"
  | "Synaptosome" <-> "KW-0771\">Synaptosome"
  | "Systemic lupus erythematosus" <-> "KW-0772\">Systemic lupus erythematosus"
  | "Taste" <-> "KW-0919\">Taste"
  | "Taste-modifying protein" <-> "KW-0776\">Taste-modifying protein"
  | "Taxol biosynthesis" <-> "KW-0876\">Taxol biosynthesis"
  | "Tegument protein" <-> "KW-0920\">Tegument protein"
  | "Teichoic acid biosynthesis" <-> "KW-0777\">Teichoic acid biosynthesis"
  | "Tellurium resistance" <-> "KW-0778\">Tellurium resistance"
  | "Telomere" <-> "KW-0779\">Telomere"
  | "Terminal addition" <-> "KW-0780\">Terminal addition"
  | "Tetrahydrobiopterin biosynthesis" <-> "KW-0783\">Tetrahydrobiopterin biosynthesis"
  | "Thiamine biosynthesis" <-> "KW-0784\">Thiamine biosynthesis"
  | "Thiamine catabolism" <-> "KW-0785\">Thiamine catabolism"
  | "Thiamine pyrophosphate" <-> "KW-0786\">Thiamine pyrophosphate"
  | "Thick filament" <-> "KW-0787\">Thick filament"
  | "Thioester bond" <-> "KW-0882\">Thioester bond"
  | "Thioether bond" <-> "KW-0883\">Thioether bond"
  | "Thiol protease inhibitor" <-> "KW-0789\">Thiol protease inhibitor"
  | "Thiol protease" <-> "KW-0788\">Thiol protease"
  | "Threonine biosynthesis" <-> "KW-0791\">Threonine biosynthesis"
  | "Threonine protease" <-> "KW-0888\">Threonine protease"
  | "Thrombophilia" <-> "KW-0792\">Thrombophilia"
  | "Thylakoid" <-> "KW-0793\">Thylakoid"
  | "Thyroid hormone" <-> "KW-0795\">Thyroid hormone"
  | "Thyroid hormones biosynthesis" <-> "KW-0893\">Thyroid hormones biosynthesis"
  | "Tight junction" <-> "KW-0796\">Tight junction"
  | "Tissue remodeling" <-> "KW-0797\">Tissue remodeling"
  | "TonB box" <-> "KW-0798\">TonB box"
  | "Topoisomerase" <-> "KW-0799\">Topoisomerase"
  | "Toxin" <-> "KW-0800\">Toxin"
  | "TPQ" <-> "KW-0801\">TPQ"
  | "TPR repeat" <-> "KW-0802\">TPR repeat"
  | "Transcription antitermination" <-> "KW-0889\">Transcription antitermination"
  | "Transcription" <-> "KW-0804\">Transcription"
  | "Transcription regulation" <-> "KW-0805\">Transcription regulation"
  | "Transcription termination" <-> "KW-0806\">Transcription termination"
  | "Transducer" <-> "KW-0807\">Transducer"
  | "Transferase" <-> "KW-0808\">Transferase"
  | "Transit peptide" <-> "KW-0809\">Transit peptide"
  | "Translation regulation" <-> "KW-0810\">Translation regulation"
  | "Translocation" <-> "KW-0811\">Translocation"
  | "Transmembrane" <-> "KW-0812\">Transmembrane"
  | "Transport" <-> "KW-0813\">Transport"
  | "Transposable element" <-> "KW-0814\">Transposable element"
  | "Transposition" <-> "KW-0815\">Transposition"
  | "Tricarboxylic acid cycle" <-> "KW-0816\">Tricarboxylic acid cycle"
  | "Trimethoprim resistance" <-> "KW-0817\">Trimethoprim resistance"
  | "Triplet repeat expansion" <-> "KW-0818\">Triplet repeat expansion"
  | "tRNA-binding" <-> "KW-0820\">tRNA-binding"
  | "tRNA processing" <-> "KW-0819\">tRNA processing"
  | "Trypanosomiasis" <-> "KW-0821\">Trypanosomiasis"
  | "Tryptophan biosynthesis" <-> "KW-0822\">Tryptophan biosynthesis"
  | "Tryptophan catabolism" <-> "KW-0823\">Tryptophan catabolism"
  | "TTQ" <-> "KW-0824\">TTQ"
  | "Tumor antigen" <-> "KW-0825\">Tumor antigen"
  | "Tungsten" <-> "KW-0826\">Tungsten"
  | "Two-component regulatory system" <-> "KW-0902\">Two-component regulatory system"
  | "Tyrosine biosynthesis" <-> "KW-0827\">Tyrosine biosynthesis"
  | "Tyrosine catabolism" <-> "KW-0828\">Tyrosine catabolism"
  | "Tyrosine-protein kinase" <-> "KW-0829\">Tyrosine-protein kinase"
  | "Ubiquinone biosynthesis" <-> "KW-0831\">Ubiquinone biosynthesis"
  | "Ubiquinone" <-> "KW-0830\">Ubiquinone"
  | "Ubl conjugation" <-> "KW-0832\">Ubl conjugation"
  | "Ubl conjugation pathway" <-> "KW-0833\">Ubl conjugation pathway"
  | "Unfolded protein response" <-> "KW-0834\">Unfolded protein response"
  | "Urea cycle" <-> "KW-0835\">Urea cycle"
  | "Usher syndrome" <-> "KW-0836\">Usher syndrome"
  | "Vacuole" <-> "KW-0926\">Vacuole"
  | "Vanadium" <-> "KW-0837\">Vanadium"
  | "Vasoactive" <-> "KW-0838\">Vasoactive"
  | "Vasoconstrictor" <-> "KW-0839\">Vasoconstrictor"
  | "Vasodilator" <-> "KW-0840\">Vasodilator"
  | "Viral immunoevasion" <-> "KW-0899\">Viral immunoevasion"
  | "Viral matrix protein" <-> "KW-0468\">Viral matrix protein"
  | "Viral movement protein" <-> "KW-0916\">Viral movement protein"
  | "Viral nucleoprotein" <-> "KW-0543\">Viral nucleoprotein"
  | "Viral occlusion body" <-> "KW-0842\">Viral occlusion body"
  | "Virion protein" <-> "KW-0946\">Virion protein"
  | "Virulence" <-> "KW-0843\">Virulence"
  | "Vision" <-> "KW-0844\">Vision"
  | "Vitamin A" <-> "KW-0845\">Vitamin A"
  | "Vitamin C" <-> "KW-0847\">Vitamin C"
  | "Vitamin D" <-> "KW-0848\">Vitamin D"
  | "VLDL" <-> "KW-0850\">VLDL"
  | "Voltage-gated channel" <-> "KW-0851\">Voltage-gated channel"
  | "von Willebrand disease" <-> "KW-0852\">von Willebrand disease"
  | "Waardenburg syndrome" <-> "KW-0897\">Waardenburg syndrome"
  | "WD repeat" <-> "KW-0853\">WD repeat"
  | "Whooping cough" <-> "KW-0855\">Whooping cough"
  | "Williams-Beuren syndrome" <-> "KW-0856\">Williams-Beuren syndrome"
  | "Wnt signaling pathway" <-> "KW-0879\">Wnt signaling pathway"
  | "Xeroderma pigmentosum" <-> "KW-0857\">Xeroderma pigmentosum"
  | "Xylan degradation" <-> "KW-0858\">Xylan degradation"
  | "Xylose metabolism" <-> "KW-0859\">Xylose metabolism"
  | "Zellweger syndrome" <-> "KW-0861\">Zellweger syndrome"
  | "Zinc-finger" <-> "KW-0863\">Zinc-finger"
  | "Zinc" <-> "KW-0862\">Zinc"
  | "Zinc transport" <-> "KW-0864\">Zinc transport"
  | "Zymogen" <-> "KW-0865\">Zymogen" )

let KW = 
  let keyword = 
    ins "  <keyword id=\"" .  corres_kw_id . ins"</keyword>\n" in
  del_beg_line "KW" . (keyword .del ";" . del_spaces_bis)* . keyword . del".\n"



test KW get 
<<<KW   Complete proteome; Differentiation; Viral movement protein; Zymogen; 2Fe-2S.
>>>
=
<<<  <keyword id="KW-0181">Complete proteome</keyword>
  <keyword id="KW-0221">Differentiation</keyword>
  <keyword id="KW-0916">Viral movement protein</keyword>
  <keyword id="KW-0865">Zymogen</keyword>
  <keyword id="KW-0001">2Fe-2S</keyword>
>>>





let FT_single_bound (name:string) (min_space:string) (num_reg:regexp) = 
  xml_begin_open_tag "      " name .
  del min_space .
  (
    (((del "<" . xml_simple_attribute "status" "less than")
     |(del ">" . xml_simple_attribute "status" "greater than") 
     |(del "?" . xml_simple_attribute "status" "uncertain")) . 
      xml_space)
   | del " ") . 
  xml_attribute "position" num_reg "" . xml_sgt . xml_nl

let FT_bound (name:string) = 
    FT_single_bound name "    " ([0-9]{1})
  | FT_single_bound name "   " ([0-9]{2})
  | FT_single_bound name "  " ([0-9]{3})
  | FT_single_bound name " " ([0-9]{4})
  | FT_single_bound name "" ([0-9]{5})
  | (del "     ?" . xml_tag_with_single_att "      " name "status" (ins "unknown"))


(* note that when begining and end are equal, there should be a unique
 * markup "position", but it's not recognisable *)
let FT_bounds = 
  xml_opening_tag "    " "location" .
  FT_bound "begin" . del " " .  FT_bound "end" .
  xml_closing_tag "    " "location"

let FT_orig_var = 
  (xml_tag "    " "original" [A-Z]* . del " -> " .
     xml_tag "    " "variation" [A-Z]*) | del "Missing"

let FT_id =
  (del " /FTId=" . xml_attribute "id" (escape_name [.""]) " " . del ".")?

let FT_descr = 
  xml_attribute "description" 
  (([^(""<>&] . escape_name [.""]) | ("(" . escape_name [)""] . ")" )) 
  "" . del "." 

let normal_FT = 
  del_beg_line "FT" .
  xml_begin_open_tag "  " "feature" . 
  xml_attribute "type" 
    (  "ACT_SITE" <-> "active site"
     | "BINDING " <-> "binding site"
     | "CA_BIND " <-> "calcium-binding region"
     | "CHAIN   " <-> "chain"
     | "COILED  " <-> "coiled-coil region"
     | "COMPBIAS" <-> "compositionally biased region"
     | "CROSSLNK" <-> "cross-link"
     | "DISULFID" <-> "disulfide bond"
     | "DNA_BIND" <-> "DNA-binding region"
     | "DOMAIN  " <-> "domain"
     | "CARBOHYD" <-> "glycosylation site"
     | "HELIX   " <-> "helix"
     | "INIT_MET" <-> "initiator methionine"
     | "LIPID   " <-> "lipid moiety-binding region"
     | "METAL   " <-> "metal ion-binding site"
     | "MOD_RES " <-> "modified residue"
     | "NON_CONS" <-> "non-consecutive residues"
     | "NON_TER " <-> "non-terminal residue"
     | "NP_BIND " <-> "nucleotide phosphate-binding region"
     | "PEPTIDE " <-> "peptide"
     | "PROPEP  " <-> "propeptide"
     | "REGION  " <-> "region of interest"
     | "REPEAT  " <-> "repeat"
     | "SE_CYS  " <-> "selenocysteine"
     | "MOTIF   " <-> "short sequence motif"
     | "SIGNAL  " <-> "signal peptide"
     | "SITE    " <-> "site"
     | "STRAND  " <-> "strand"
     | "TOPO_DOM" <-> "topological domain"
     | "TRANSIT " <-> "transit peptide"
     | "TRANSMEM" <-> "transmembrane region"
     | "TURN    " <-> "turn"
     | "UNSURE  " <-> "unsure residue"
     | "ZN_FING " <-> "zinc finger region") " ".
  del " " . (FT_bounds ~ ((del "       " . FT_descr ~ FT_id)? . xml_gt . xml_nl)) . 
  xml_closing_tag "  " "feature" . del "\n"





let FT_with_var = 
  del_beg_line "FT" .
  xml_begin_open_tag "  " "feature" . 
  xml_attribute "type" 
    ( "MUTAGEN " <-> "mutagenesis site"
    | "CONFLICT" <-> "sequence conflict"
    | "VARIANT " <-> "sequence variant"
    | "VAR_SEQ " <-> "splice variant") " ".
  del " " . ((FT_bounds ~ (del "       " . FT_orig_var)) ~ ((del " " . FT_descr ~ FT_id)? . xml_gt . xml_nl)) . 
  xml_closing_tag "  " "feature" . del "\n"



let FT = 
 normal_FT | FT_with_var

test FT* get 
<<<
    FT   CHAIN        22    296       11S globulin gamma chain. /FTId=PRO_0000032028.
    FT   STRAND      197    202
    FT   DISULFID    124    303       Interchain (between gamma and delta chains) (Potential).
    FT   CONFLICT     27     27       S -> E (in Ref. 2).
    FT   VAR_SEQ     243    244       Missing (in isoform 2). /FTId=VSP_008971.

>>> = 
<<<  <feature type="chain" id="PRO_0000032028" description="11S globulin gamma chain">
    <location>
      <begin position="22"/>
      <end position="296"/>
    </location>
  </feature>
  <feature type="strand" >
    <location>
      <begin position="197"/>
      <end position="202"/>
    </location>
  </feature>
  <feature type="disulfide bond" description="Interchain (between gamma and delta chains) (Potential)">
    <location>
      <begin position="124"/>
      <end position="303"/>
    </location>
  </feature>
  <feature type="sequence conflict" description="(in Ref. 2)">
    <original>S</original>
    <variation>E</variation>
    <location>
      <begin position="27"/>
      <end position="27"/>
    </location>
  </feature>
  <feature type="splice variant" id="VSP_008971" description="(in isoform 2)">
    <location>
      <begin position="243"/>
      <end position="244"/>
    </location>
  </feature>
>>>


(*

dirty comments to be kept until I (pilki) remove it

  <feature type="chain" id="PRO_0000069090" description="Alpha-2B adrenergic receptor">
  <location>
  <begin status="less than" position="1"/>
  <end status="greater than" position="384"/>
  </location>
  </feature>

  <end status="unknown"/>



  <feature type="peptide" evidence="EC1" description="Arenicin-1. /FTId=PRO_0000020732">
    <location>
      <begin position="182"/>
      <end position="202"/>
    </location>
  </feature>



  | "ACT_SITE" <-> "active site"
  | "BINDING " <-> "binding site"
  | "CA_BIND " <-> "calcium-binding region"
  | "CHAIN   " <-> "chain"
  | "COILED  " <-> "coiled-coil region"
  | "COMPBIAS" <-> "compositionally biased region"
  | "CROSSLNK" <-> "cross-link"
  | "DISULFID" <-> "disulfide bond"
  | "DNA_BIND" <-> "DNA-binding region"
  | "DOMAIN  " <-> "domain"
  | "CARBOHYD" <-> "glycosylation site"
  | "HELIX   " <-> "helix"
  | "INIT_MET" <-> "initiator methionine"
  | "LIPID   " <-> "lipid moiety-binding region"
  | "METAL   " <-> "metal ion-binding site"
  | "MOD_RES " <-> "modified residue"
  | "MUTAGEN " <-> "mutagenesis site"<=========
  | "NON_CONS" <-> "non-consecutive residues"
  | "NON_TER " <-> "non-terminal residue"
  | "NP_BIND " <-> "nucleotide phosphate-binding region"
  | "PEPTIDE " <-> "peptide"
  | "PROPEP  " <-> "propeptide"
  | "REGION  " <-> "region of interest"
  | "REPEAT  " <-> "repeat"
  | "SE_CYS  " <-> "selenocysteine"
  | "CONFLICT" <-> "sequence conflict"<=========
  | "VARIANT " <-> "sequence variant" <=========
  | "MOTIF   " <-> "short sequence motif"
  | "SIGNAL  " <-> "signal peptide"
  | "SITE    " <-> "site"
  | "VAR_SEQ " <-> "splice variant" <=========
  | "STRAND  " <-> "strand"
  | "TOPO_DOM" <-> "topological domain"
  | "TRANSIT " <-> "transit peptide"
  | "TRANSMEM" <-> "transmembrane region"
  | "TURN    " <-> "turn"
  | "UNSURE  " <-> "unsure residue"
  | "ZN_FING " <-> "zinc finger region"


  VAR_SEQ
  VARIANT


truc entre parenthse (status)
by similarity
potential
probable

FT   MUTAGEN     206    208       Missing: Abolishes 1-aminocyclopropane-1-



SQ   SEQUENCE   80 AA;  8372 MW;  AD289A48EAB19E0E CRC64;
SQ   SEQUENCE   159 AA;  16581 MW;  206A2BBF74FCE169 CRC64;
DICHEVLTLL

*)


let beg_SQ = 
  del_beg_line "SQ" . del "SEQUENCE   ".
  xml_begin_open_tag "  " "sequence"

let end_SQ = 
  ((xml_attribute "length" [0-9]+ " " . del " AA;  ") ~ (xml_attribute "mass" [0-9]+ " " . del " MW;  ")).
  xml_attribute "checksum" [0-9A-Z]+ "" . del " CRC64;\n" . xml_gt .
  (del "    " . (del " " . [A-Z]{10}){6} . del "\n")* . 
  del "    " . (del " " . [A-Z]{10}){0,5} .  del " " . [A-Z]{1,10} .
  xml_closing_tag "" "sequence" . del "\n//\n"


(*
test SQ get 
<<<SQ   SEQUENCE   214 AA;  24608 MW;  0B98AEF8CBCC7AD3 CRC64;
     SNNELTNEER NLLSVAYKNV VGARRSSWRV ISSIEQKTEG SERKQQMAKD YREKIEKELK DICHEVLTLL DKFLIPKATT AESKVFYLKM KGDYYRYLAE VATGDERQKV IEESQRAYND KDSTLIMQLL RDNLTLWTSD TGGDDDANAP DEHQ
//
>>> = 
<<<  <sequence mass="24608" length="214" checksum="0B98AEF8CBCC7AD3">SNNELTNEERNLLSVAYKNVVGARRSSWRVISSIEQKTEGSERKQQMAKDYREKIEKELKDICHEVLTLLDKFLIPKATTAESKVFYLKMKGDYYRYLAEVATGDERQKVIEESQRAYNDKDSTLIMQLLRDNLTLWTSDTGGDDDANAPDEHQ</sequence>
>>>

test SQ create 
<<<    <sequence mass="24608" length="214" checksum="0B98AEF8CBCC7AD3">SNNELTNEERNLLSVAYKNVVGARRSSWRVISSIEQKTEGSERKQQMAKDYREKIEKELKDICHEVLTLLDKFLIPKATTAESKVFYLKMKGDYYRYLAEVATGDERQKVIEESQRAYNDKDSTLIMQLLRDNLTLWTSDTGGDDDANAPDEHQ</sequence>
>>>
=  
<<<SQ   SEQUENCE   214 AA;  24608 MW;  0B98AEF8CBCC7AD3 CRC64;
     SNNELTNEER NLLSVAYKNV VGARRSSWRV ISSIEQKTEG SERKQQMAKD YREKIEKELK DICHEVLTLL DKFLIPKATT AESKVFYLKM KGDYYRYLAE VATGDERQKV IEESQRAYND KDSTLIMQLL RDNLTLWTSD TGGDDDANAP DEHQ
//
>>>
*)






(* final assembly *)
let uniprot_entry = 
  ID . AC? . fst_DT . 
  (snd_DT ~ ( thd_DT . DE . GN . OS_OG_OC_OX_OH . Rlines . CC . 
	     del "CC   -----------------------------------------------------------------------\n" . 
	     del "CC   Copyrighted by the UniProt Consortium, see http://www.uniprot.org/terms\n" .
	     del "CC   Distributed under the Creative Commons Attribution-NoDerivs License\n" .
	     del "CC   -----------------------------------------------------------------------\n" .
	     DR* . PE? . KW? . FT* . beg_SQ)) .
  end_SQ   . xml_closing_tag "" "entry"
 


test uniprot_entry get 
<<<ID   104K_THEAN              Reviewed;         893 AA.
AC   Q4U9M9;
DT   18-APR-2006, integrated into UniProtKB/Swiss-Prot.
DT   05-JUL-2005, sequence version 1.
DT   23-OCT-2007, entry version 14.
DE   104 kDa microneme/rhoptry antigen precursor (p104).
GN   ORFNames=TA08425;
OS   Theileria annulata.
OC   Eukaryota; Alveolata; Apicomplexa; Aconoidasida; Piroplasmida; Theileriidae; Theileria.
OX   NCBI_TaxID=5874;
RN   [1]
RP   NUCLEOTIDE SEQUENCE [LARGE SCALE GENOMIC DNA].
RC   STRAIN=Ankara;
RX   PubMed=15994557; DOI=10.1126/science.1110418;
RA   Pain A., Renauld H., Berriman M., Murphy L., Yeats C.A., Weir W., Kerhornou A., Aslett M., Bishop R., Bouchier C., Cochet M., Coulson R.M.R., Cronin A., de Villiers E.P., Fraser A., Fosker N., Gardner M., Goble A., Griffiths-Jones S., Harris D.E., Katzer F., Larke N., Lord A., Maser P., McKellar S., Mooney P., Morton F., Nene V., O'Neil S., Price C., Quail M.A., Rabbinowitsch E., Rawlings N.D., Rutter S., Saunders D., Seeger K., Shah T., Squares R., Squares S., Tivey A., Walker A.R., Woodward J., Dobbelaere D.A.E., Langsley G., Rajandream M.A., McKeever D., Shiels B., Tait A., Barrell B.G., Hall N.;
RT   "Genome of the host-cell transforming parasite Theileria annulata compared with T. parva.";
RL   Science 309:131-133(2005).
CC   -!- SUBCELLULAR LOCATION: Cell membrane; Lipid-anchor, GPI-anchor (Potential). Note=In microneme/rhoptry complexes (By similarity).
CC   -----------------------------------------------------------------------
CC   Copyrighted by the UniProt Consortium, see http://www.uniprot.org/terms
CC   Distributed under the Creative Commons Attribution-NoDerivs License
CC   -----------------------------------------------------------------------
DR   EMBL; CR940353; CAI76474.1; -; Genomic_DNA.
DR   KEGG; tan:TA08425; -.
DR   InterPro; IPR007480; DUF529.
DR   Pfam; PF04385; FAINT; 4.
PE   3: Inferred from homology;
KW   Complete proteome; Glycoprotein; GPI-anchor; Lipoprotein; Membrane; Repeat; Signal; Sporozoite.
FT   SIGNAL        1     19       Potential.
FT   CHAIN        20    873       104 kDa microneme/rhoptry antigen. /FTId=PRO_0000232680.
FT   PROPEP      874    893       Removed in mature form (Potential). /FTId=PRO_0000232681.
FT   COMPBIAS    215    220       Poly-Leu.
FT   COMPBIAS    486    683       Lys-rich.
FT   COMPBIAS    854    859       Poly-Arg.
FT   LIPID       873    873       GPI-anchor amidated aspartate (Potential).
SQ   SEQUENCE   893 AA;  101921 MW;  2F67CEB3B02E7AC1 CRC64;
     MKFLVLLFNI LCLFPILGAD ELVMSPIPTT DVQPKVTFDI NSEVSSGPLY LNPVEMAGVK
     YLQLQRQPGV QVHKVVEGDI VIWENEEMPL YTCAIVTQNE VPYMAYVELL EDPDLIFFLK
     EGDQWAPIPE DQYLARLQQL RQQIHTESFF SLNLSFQHEN YKYEMVSSFQ HSIKMVVFTP
     KNGHICKMVY DKNIRIFKAL YNEYVTSVIG FFRGLKLLLL NIFVIDDRGM IGNKYFQLLD
     DKYAPISVQG YVATIPKLKD FAEPYHPIIL DISDIDYVNF YLGDATYHDP GFKIVPKTPQ
     CITKVVDGNE VIYESSNPSV ECVYKVTYYD KKNESMLRLD LNHSPPSYTS YYAKREGVWV
     TSTYIDLEEK IEELQDHRST ELDVMFMSDK DLNVVPLTNG NLEYFMVTPK PHRDIIIVFD
     GSEVLWYYEG LENHLVCTWI YVTEGAPRLV HLRVKDRIPQ NTDIYMVKFG EYWVRISKTQ
     YTQEIKKLIK KSKKKLPSIE EEDSDKHGGP PKGPEPPTGP GHSSSESKEH EDSKESKEPK
     EHGSPKETKE GEVTKKPGPA KEHKPSKIPV YTKRPEFPKK SKSPKRPESP KSPKRPVSPQ
     RPVSPKSPKR PESLDIPKSP KRPESPKSPK RPVSPQRPVS PRRPESPKSP KSPKSPKSPK
     VPFDPKFKEK LYDSYLDKAA KTKETVTLPP VLPTDESFTH TPIGEPTAEQ PDDIEPIEES
     VFIKETGILT EEVKTEDIHS ETGEPEEPKR PDSPTKHSPK PTGTHPSMPK KRRRSDGLAL
     STTDLESEAG RILRDPTGKI VTMKRSKSFD DLTTVREKEH MGAEIRKIVV DDDGTEADDE
     DTHPSKEKHL STVRRRRPRP KKSSKSSKPR KPDSAFVPSI IFIFLVSLIV GIL
//
>>> = ?




(*<<<
<entry version="14" modified="2007-10-23" dataset="Swiss-Prot" created="2006-04-18">
  <accession>Q4U9M9</accession>
  <name>104K_THEAN</name>
  <protein>
    <name>104 kDa microneme/rhoptry antigen precursor</name>
    <name>p104</name>
  </protein>
  <gene>
    <name type="ORF">TA08425</name>
  </gene>
  <organism key="1">
    <name type="scientific">Theileria annulata</name>
    <dbReference type="NCBI Taxonomy" key="" id="5874"/>
    <lineage>
      <taxon>Eukaryota</taxon>
      <taxon>Alveolata</taxon>
      <taxon>Apicomplexa</taxon>
      <taxon>Aconoidasida</taxon>
      <taxon>Piroplasmida</taxon>
      <taxon>Theileriidae</taxon>
      <taxon>Theileria</taxon>
    </lineage>
  </organism>
  <reference key="">
    <citation volume="309" type="journal article" name="Science" last="133" first="131" date="2005">
      <title>Genome of the host-cell transforming parasite Theileria annulata compared with T. parva.</title>
      <authorList>
        <person name="Pain A."/>
        <person name="Renauld H."/>
        <person name="Berriman M."/>
        <person name="Murphy L."/>
        <person name="Yeats C.A."/>
        <person name="Weir W."/>
        <person name="Kerhornou A."/>
        <person name="Aslett M."/>
        <person name="Bishop R."/>
        <person name="Bouchier C."/>
        <person name="Cochet M."/>
        <person name="Coulson R.M.R."/>
        <person name="Cronin A."/>
        <person name="de Villiers E.P."/>
        <person name="Fraser A."/>
        <person name="Fosker N."/>
        <person name="Gardner M."/>
        <person name="Goble A."/>
        <person name="Griffiths-Jones S."/>
        <person name="Harris D.E."/>
        <person name="Katzer F."/>
        <person name="Larke N."/>
        <person name="Lord A."/>
        <person name="Maser P."/>
        <person name="McKellar S."/>
        <person name="Mooney P."/>
        <person name="Morton F."/>
        <person name="Nene V."/>
        <person name="O'Neil S."/>
        <person name="Price C."/>
        <person name="Quail M.A."/>
        <person name="Rabbinowitsch E."/>
        <person name="Rawlings N.D."/>
        <person name="Rutter S."/>
        <person name="Saunders D."/>
        <person name="Seeger K."/>
        <person name="Shah T."/>
        <person name="Squares R."/>
        <person name="Squares S."/>
        <person name="Tivey A."/>
        <person name="Walker A.R."/>
        <person name="Woodward J."/>
        <person name="Dobbelaere D.A.E."/>
        <person name="Langsley G."/>
        <person name="Rajandream M.A."/>
        <person name="McKeever D."/>
        <person name="Shiels B."/>
        <person name="Tait A."/>
        <person name="Barrell B.G."/>
        <person name="Hall N."/>
      </authorList>
      <dbReference type="DOI" key="1" id="10.1126/science.1110418"/>
      <dbReference type="PubMed" key="1" id="15994557"/>
    </citation>
    <scope>NUCLEOTIDE SEQUENCE [LARGE SCALE GENOMIC DNA]</scope>
    <source>
      <strain>Ankara</strain>
    </source>
  </reference>
  <comment type="subcellular location" status="By similarity">
    <text>Cell membrane; Lipid-anchor, GPI-anchor (Potential). Note=In microneme/rhoptry complexes.</text>
  </comment>
  <dbReference type="EMBL" key="1" id="CR940353">
    <property value="CAI76474.1" type="protein sequence ID"/>
    <property value="Genomic_DNA" type="molecule type"/>
  </dbReference>
  <dbReference type="KEGG" key="1" id="tan:TA08425"/>
  <dbReference type="InterPro" key="1" id="IPR007480">
    <property value="DUF529" type="entry name"/>
  </dbReference>
  <dbReference type="Pfam" key="1" id="PF04385">
    <property value="FAINT" type="entry name"/>
    <property value="4" type="match status"/>
  </dbReference>
  <proteinExistence type="Inferred from homology"/>
  <keyword id="KW-0181">Complete proteome</keyword>
  <keyword id="KW-0325">Glycoprotein</keyword>
  <keyword id="KW-0336">GPI-anchor</keyword>
  <keyword id="KW-0449">Lipoprotein</keyword>
  <keyword id="KW-0472">Membrane</keyword>
  <keyword id="KW-0677">Repeat</keyword>
  <keyword id="KW-0732">Signal</keyword>
  <keyword id="KW-0748">Sporozoite</keyword>
  <feature type="signal peptide" status="potential">
    <location>
      <begin position="1"/>
      <end position="19"/>
    </location>
  </feature>
  <feature type="chain" id="PRO_0000232680" description="104 kDa microneme/rhoptry antigen">
    <location>
      <begin position="20"/>
      <end position="873"/>
    </location>
  </feature>
  <feature type="propeptide" status="potential" id="PRO_0000232681" description="Removed in mature form">
    <location>
      <begin position="874"/>
      <end position="893"/>
    </location>
  </feature>
  <feature type="compositionally biased region" description="Poly-Leu">
    <location>
      <begin position="215"/>
      <end position="220"/>
    </location>
  </feature>
  <feature type="compositionally biased region" description="Lys-rich">
    <location>
      <begin position="486"/>
      <end position="683"/>
    </location>
  </feature>
  <feature type="compositionally biased region" description="Poly-Arg">
    <location>
      <begin position="854"/>
      <end position="859"/>
    </location>
  </feature>
  <feature type="lipid moiety-binding region" status="potential" description="GPI-anchor amidated aspartate">
    <location>
      <position position="873"/>
    </location>
  </feature>
  <sequence version="1" modified="2005-07-05" mass="101921" length="893" checksum="2F67CEB3B02E7AC1">MKFLVLLFNILCLFPILGADELVMSPIPTTDVQPKVTFDINSEVSSGPLYLNPVEMAGVKYLQLQRQPGVQVHKVVEGDIVIWENEEMPLYTCAIVTQNEVPYMAYVELLEDPDLIFFLKEGDQWAPIPEDQYLARLQQLRQQIHTESFFSLNLSFQHENYKYEMVSSFQHSIKMVVFTPKNGHICKMVYDKNIRIFKALYNEYVTSVIGFFRGLKLLLLNIFVIDDRGMIGNKYFQLLDDKYAPISVQGYVATIPKLKDFAEPYHPIILDISDIDYVNFYLGDATYHDPGFKIVPKTPQCITKVVDGNEVIYESSNPSVECVYKVTYYDKKNESMLRLDLNHSPPSYTSYYAKREGVWVTSTYIDLEEKIEELQDHRSTELDVMFMSDKDLNVVPLTNGNLEYFMVTPKPHRDIIIVFDGSEVLWYYEGLENHLVCTWIYVTEGAPRLVHLRVKDRIPQNTDIYMVKFGEYWVRISKTQYTQEIKKLIKKSKKKLPSIEEEDSDKHGGPPKGPEPPTGPGHSSSESKEHEDSKESKEPKEHGSPKETKEGEVTKKPGPAKEHKPSKIPVYTKRPEFPKKSKSPKRPESPKSPKRPVSPQRPVSPKSPKRPESLDIPKSPKRPESPKSPKRPVSPQRPVSPRRPESPKSPKSPKSPKSPKVPFDPKFKEKLYDSYLDKAAKTKETVTLPPVLPTDESFTHTPIGEPTAEQPDDIEPIEESVFIKETGILTEEVKTEDIHSETGEPEEPKRPDSPTKHSPKPTGTHPSMPKKRRRSDGLALSTTDLESEAGRILRDPTGKIVTMKRSKSFDDLTTVREKEHMGAEIRKIVVDDDGTEADDEDTHPSKEKHLSTVRRRRPRPKKSSKSSKPRKPDSAFVPSIIFIFLVSLIVGIL</sequence>
</entry>

>>>
	       *)
